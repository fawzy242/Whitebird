var e=Object.defineProperty,t=(t,s,a)=>((t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a)(t,"symbol"!=typeof s?s+"":s,a);function s(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}import{b as a,M as n}from"./vendor-bootstrap-CHzpNLWt.js";import{C as i,r as o}from"./vendor-chart-CJOavyAH.js";/* empty css                           */import{a as r}from"./vendor-axios-DDVHPqWP.js";import"./vendor-Cj4--NNp.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const c="auth_token",l="refresh_token",d="csrf_token",h="user_data";const u=new class{constructor(){this.prefix="redadmin_",this.storage=window.localStorage,this.sessionStorage=window.sessionStorage}getPrefixedKey(e){return"".concat(this.prefix).concat(e)}setItem(e,t,s=!1){try{const a=this.getPrefixedKey(e),n=JSON.stringify(t);return s?this.sessionStorage.setItem(a,n):this.storage.setItem(a,n),!0}catch(a){return!1}}getItem(e,t=!1){try{const s=this.getPrefixedKey(e),a=t?this.sessionStorage.getItem(s):this.storage.getItem(s);return a?JSON.parse(a):null}catch(s){return null}}removeItem(e,t=!1){try{const s=this.getPrefixedKey(e);return t?this.sessionStorage.removeItem(s):this.storage.removeItem(s),!0}catch(s){return!1}}clear(e=!1){try{const t=e?this.sessionStorage:this.storage;return Object.keys(t).forEach(e=>{e.startsWith(this.prefix)&&t.removeItem(e)}),!0}catch(t){return!1}}isAvailable(){try{const e="__storage_test__";return this.storage.setItem(e,"test"),this.storage.removeItem(e),!0}catch(e){return!1}}getAllKeys(e=!1){const t=e?this.sessionStorage:this.storage;return Object.keys(t).filter(e=>e.startsWith(this.prefix)).map(e=>e.replace(this.prefix,""))}getStorageSize(e=!1){const t=e?this.sessionStorage:this.storage;let s=0;for(const a in t)t.hasOwnProperty(a)&&a.startsWith(this.prefix)&&(s+=t[a].length+a.length);return s}setToken(e){return this.setItem(c,e)}getToken(){return this.getItem(c)}removeToken(){return this.removeItem(c)}setRefreshToken(e){return this.setItem(l,e)}getRefreshToken(){return this.getItem(l)}removeRefreshToken(){return this.removeItem(l)}setCsrfToken(e){return this.setItem(d,e,!0)}getCsrfToken(){return this.getItem(d,!0)}setUser(e){return this.setItem(h,e)}getUser(){return this.getItem(h)}removeUser(){return this.removeItem(h)}clearAuth(){return this.removeToken(),this.removeRefreshToken(),this.removeUser(),this.removeItem(d,!0),!0}isAuthenticated(){return!!this.getToken()}setTempData(e,t){return this.setItem(e,t,!0)}getTempData(e){return this.getItem(e,!0)}removeTempData(e){return this.removeItem(e,!0)}},m=parseInt(void 0)||3e4,g=r.create({baseURL:"",timeout:m,headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});g.interceptors.request.use(e=>{const t=u.getToken();return t&&(e.headers.Authorization="Bearer ".concat(t)),e.headers["X-Request-ID"]=Date.now(),e},e=>Promise.reject(e)),g.interceptors.response.use(e=>{var t,s,a;return"blob"===e.config.responseType||"arraybuffer"===e.config.responseType||(null==(t=e.headers["content-type"])?void 0:t.includes("application/vnd.openxmlformats"))||(null==(s=e.headers["content-type"])?void 0:s.includes("application/octet-stream"))||(null==(a=e.headers["content-disposition"])?void 0:a.includes("attachment"))?e:{...e,data:{...e.data,isSuccess:!0,status:e.status}}},e=>{var t,s,a,n,i,o,r,c,l;return 401===(null==(t=e.response)?void 0:t.status)?(u.clearAuth(),window.dispatchEvent(new CustomEvent("auth:session-expired")),Promise.reject({message:"Your session has expired. Please login again.",status:401,isSuccess:!1,requiresLogin:!0})):e.response?Promise.reject({message:(null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.message)||(null==(i=null==(n=e.response)?void 0:n.data)?void 0:i.error)||e.message||"API request failed",status:null==(o=e.response)?void 0:o.status,data:null==(r=e.response)?void 0:r.data,isSuccess:!1,validationErrors:(null==(l=null==(c=e.response)?void 0:c.data)?void 0:l.errors)||null}):Promise.reject({message:"Network error. Please check your connection.",status:0,isSuccess:!1,isNetworkError:!0})}),g.download=async(e,t)=>{try{const s=await g.get(e,{responseType:"blob"});if(!(s.data instanceof Blob))throw new Error("Invalid response format");const a=window.URL.createObjectURL(s.data),n=document.createElement("a");return n.href=a,n.setAttribute("download",t||"download.xlsx"),document.body.appendChild(n),n.click(),setTimeout(()=>{n.remove(),window.URL.revokeObjectURL(a)},100),{success:!0}}catch(s){return{success:!1,error:s}}},g.upload=async(e,t,s)=>{try{return{success:!0,data:(await g.post(e,t,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:s})).data}}catch(a){return{success:!1,error:a}}};const p=new class{constructor(){t(this,"endpoints",{LOGIN:"/api/auth/login",ME:"/api/auth/me",CHANGE_PASSWORD:"/api/auth/change-password",FORGOT_PASSWORD:"/api/auth/forgot-password",RESET_PASSWORD:"/api/auth/reset-password",RESET_PASSWORD_WITH_TOKEN:"/api/auth/reset-password-with-token"})}async login(e,t){var s;try{const a=await g.post(this.endpoints.LOGIN,{email:e,password:t});return a.data.isSuccess&&(null==(s=a.data.data)?void 0:s.token)&&(u.setToken(a.data.data.token),a.data.data.user&&u.setUser(a.data.data.user)),a.data}catch(a){throw a}}async getMe(){try{return(await g.get(this.endpoints.ME)).data}catch(e){throw e}}async changePassword(e){try{return(await g.post(this.endpoints.CHANGE_PASSWORD,e)).data}catch(t){throw t}}async forgotPassword(e){try{return(await g.post(this.endpoints.FORGOT_PASSWORD,{email:e})).data}catch(t){throw t}}async resetPassword(e){try{return(await g.post(this.endpoints.RESET_PASSWORD,e)).data}catch(t){throw t}}async resetPasswordWithToken(e){try{return(await g.post(this.endpoints.RESET_PASSWORD_WITH_TOKEN,e)).data}catch(t){throw t}}logout(){return u.clearAuth(),{success:!0,message:"Logged out successfully"}}isAuthenticated(){return u.isAuthenticated()}getCurrentUser(){return u.getUser()}async refreshToken(){try{const e=await g.post("/api/auth/refresh");return e.data.token&&u.setToken(e.data.token),e.data}catch(e){throw e}}};const y=new class{constructor(){t(this,"endpoints",{ASSET:"/api/asset",ASSET_BY_ID:"/api/asset/{id}",ASSET_GRID:"/api/asset/grid",ASSET_SEARCH:"/api/asset/search"})}replaceParams(e,t){return e.replace(/{(\w+)}/g,(e,s)=>t[s]||"")}async getAssets(){try{return(await g.get(this.endpoints.ASSET)).data}catch(e){throw e}}async getAssetsGrid(e={}){try{return(await g.get(this.endpoints.ASSET_GRID,{params:e})).data}catch(t){throw t}}async getAsset(e){try{const t=this.replaceParams(this.endpoints.ASSET_BY_ID,{id:e});return(await g.get(t)).data}catch(t){throw t}}async createAsset(e){try{return(await g.post(this.endpoints.ASSET,e)).data}catch(t){throw t}}async updateAsset(e,t){try{const s=this.replaceParams(this.endpoints.ASSET_BY_ID,{id:e});return(await g.put(s,t)).data}catch(s){throw s}}async deleteAsset(e){try{const t=this.replaceParams(this.endpoints.ASSET_BY_ID,{id:e});return(await g.delete(t)).data}catch(t){throw t}}async searchAssets(e,t=1,s=10){try{return(await g.get(this.endpoints.ASSET_GRID,{params:{search:e,page:t,pageSize:s}})).data}catch(a){throw a}}};const f=new class{constructor(){t(this,"endpoints",{EMPLOYEE:"/api/employee",EMPLOYEE_BY_ID:"/api/employee/{id}",EMPLOYEE_ACTIVE:"/api/employee/active",EMPLOYEE_GRID:"/api/employee/grid"})}replaceParams(e,t){return e.replace(/{(\w+)}/g,(e,s)=>t[s]||"")}async getEmployees(e={}){try{return(await g.get(this.endpoints.EMPLOYEE,{params:e})).data}catch(t){throw t}}async getActiveEmployees(){try{return(await g.get(this.endpoints.EMPLOYEE_ACTIVE)).data}catch(e){throw e}}async getEmployeesGrid(e={}){try{return(await g.get(this.endpoints.EMPLOYEE_GRID,{params:e})).data}catch(t){throw t}}async getEmployee(e){try{const t=this.replaceParams(this.endpoints.EMPLOYEE_BY_ID,{id:e});return(await g.get(t)).data}catch(t){throw t}}async createEmployee(e){try{return(await g.post(this.endpoints.EMPLOYEE,e)).data}catch(t){throw t}}async updateEmployee(e,t){try{const s=this.replaceParams(this.endpoints.EMPLOYEE_BY_ID,{id:e});return(await g.put(s,t)).data}catch(s){throw s}}async deleteEmployee(e){try{const t=this.replaceParams(this.endpoints.EMPLOYEE_BY_ID,{id:e});return(await g.delete(t)).data}catch(t){throw t}}async searchEmployees(e,t=1,s=10){try{return(await g.get(this.endpoints.EMPLOYEE_GRID,{params:{search:e,page:t,pageSize:s}})).data}catch(a){throw a}}};const v=new class{constructor(){t(this,"endpoints",{CATEGORY:"/api/category",CATEGORY_BY_ID:"/api/category/{id}",CATEGORY_ACTIVE:"/api/category/active"})}replaceParams(e,t){return e.replace(/{(\w+)}/g,(e,s)=>t[s]||"")}async getCategories(e={}){try{return(await g.get(this.endpoints.CATEGORY,{params:e})).data}catch(t){throw t}}async getActiveCategories(){try{return(await g.get(this.endpoints.CATEGORY_ACTIVE)).data}catch(e){throw e}}async getCategory(e){try{const t=this.replaceParams(this.endpoints.CATEGORY_BY_ID,{id:e});return(await g.get(t)).data}catch(t){throw t}}async createCategory(e){try{return(await g.post(this.endpoints.CATEGORY,e)).data}catch(t){throw t}}async updateCategory(e,t){try{const s=this.replaceParams(this.endpoints.CATEGORY_BY_ID,{id:e});return(await g.put(s,t)).data}catch(s){throw s}}async deleteCategory(e){try{const t=this.replaceParams(this.endpoints.CATEGORY_BY_ID,{id:e});return(await g.delete(t)).data}catch(t){throw t}}async searchCategories(e){try{return(await g.get(this.endpoints.CATEGORY,{params:{search:e}})).data}catch(t){throw t}}};const b=new class{constructor(){t(this,"endpoints",{TRANSACTIONS:"/api/assettransactions",TRANSACTIONS_BY_ID:"/api/assettransactions/{id}",TRANSACTIONS_BY_ASSET:"/api/assettransactions/asset/{assetId}"})}replaceParams(e,t){return e.replace(/{(\w+)}/g,(e,s)=>t[s]||"")}async getTransactions(e={}){try{return(await g.get(this.endpoints.TRANSACTIONS,{params:e})).data}catch(t){throw t}}async getTransaction(e){try{const t=this.replaceParams(this.endpoints.TRANSACTIONS_BY_ID,{id:e});return(await g.get(t)).data}catch(t){throw t}}async getTransactionsByAsset(e,t={}){try{const s=this.replaceParams(this.endpoints.TRANSACTIONS_BY_ASSET,{assetId:e});return(await g.get(s,{params:t})).data}catch(s){throw s}}async createTransaction(e){try{return(await g.post(this.endpoints.TRANSACTIONS,e)).data}catch(t){throw t}}async updateTransaction(e,t){try{const s=this.replaceParams(this.endpoints.TRANSACTIONS_BY_ID,{id:e});return(await g.put(s,t)).data}catch(s){throw s}}async deleteTransaction(e){try{const t=this.replaceParams(this.endpoints.TRANSACTIONS_BY_ID,{id:e});return(await g.delete(t)).data}catch(t){throw t}}async searchTransactions(e){try{return(await g.get(this.endpoints.TRANSACTIONS,{params:e})).data}catch(t){throw t}}};const w=new class{constructor(){t(this,"endpoints",{REPORTS_DATA:"/api/reports/data",REPORTS_EXCEL:"/api/reports/excel",REPORTS_EXCEL_DOWNLOAD:"/api/reports/excel/download"})}async getReportData(){try{return(await g.get(this.endpoints.REPORTS_DATA)).data}catch(e){throw e}}async generateExcelReport(){try{const t=u.getToken(),s=await fetch(this.endpoints.REPORTS_EXCEL,{method:"GET",headers:{Authorization:"Bearer ".concat(t),Accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},credentials:"include"});if(!s.ok){let t="Server error: ".concat(s.status);try{const a=await s.text();if(a)try{t=JSON.parse(a).message||t}catch(e){t=a.substring(0,200)}}catch(e){}throw new Error(t)}const a=await s.blob();if(0===a.size)throw new Error("Received empty file from server");const n=s.headers.get("content-disposition");return{success:!0,blob:a,filename:this.extractFilenameFromHeaders(n)||"Asset_Transaction_Report_".concat((new Date).toISOString().split("T")[0],".xlsx"),size:a.size}}catch(t){return await this.generateExcelReportWithAxios()}}async generateExcelReportWithAxios(){try{const e=await g.get(this.endpoints.REPORTS_EXCEL,{responseType:"blob"});let t;if(e.data instanceof Blob)t=e.data;else if(e.data instanceof ArrayBuffer)t=new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});else{const s="string"==typeof e.data?(new TextEncoder).encode(e.data):e.data;t=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})}if(0===t.size){await t.text();throw new Error("Received empty file")}return{success:!0,blob:t,filename:this.extractFilenameFromResponse(e)||"Asset_Transaction_Report_".concat((new Date).toISOString().split("T")[0],".xlsx")}}catch(e){throw e}}async downloadExcelReport(){try{const e=await this.generateExcelReport();if(!e.success||!e.blob)throw new Error("Failed to get file from server");return this.downloadBlob(e.blob,e.filename),{success:!0,filename:e.filename,size:e.size}}catch(e){throw e}}downloadBlob(e,t){if(!(e&&e instanceof Blob))throw new Error("Invalid file data");try{const s=window.URL.createObjectURL(e),a=document.createElement("a");a.href=s,a.download=t,a.style.display="none",document.body.appendChild(a),a.click(),setTimeout(()=>{document.body.removeChild(a),window.URL.revokeObjectURL(s)},100)}catch(s){throw s}}extractFilenameFromResponse(e){try{const t=e.headers["content-disposition"];if(t){const e=t.match(/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/);if(e&&e[1]){let t=e[1].replace(/['"]/g,"");return t=decodeURIComponent(t),t}}return null}catch(t){return null}}extractFilenameFromHeaders(e){if(!e)return null;try{const s=[/filename\*?=UTF-8''([^;]+)/i,/filename\*?=([^;]+)/i,/filename="?([^"]+)"?/i];for(const a of s){const s=e.match(a);if(s&&s[1]){let e=s[1];try{e=decodeURIComponent(e)}catch(t){}return e.trim()}}return null}catch(s){return null}}async testDownload(){try{await g.get("/health").catch(()=>null),await this.getReportData();return{success:!0,...await this.downloadExcelReport()}}catch(e){return{success:!1,error:e.message}}}},E=()=>(u.clearAuth(),{success:!0,message:"Logged out successfully"}),I=async()=>{try{return(await g.get("/health")).data}catch(e){throw e}},S={auth:p,asset:y,employee:f,category:v,transactions:b,reports:w,logout:E,checkHealth:I,testConnection:async()=>{try{return{success:!0,data:await I()}}catch(e){return{success:!1,error:e.message}}},testAllEndpoints:async()=>{const e={auth:!1,asset:!1,employee:!1,category:!1,transactions:!1,reports:!1};try{try{await p.getMe(),e.auth=!0}catch(t){}try{await y.getAssetsGrid({page:1,pageSize:1}),e.asset=!0}catch(t){}try{await f.getEmployeesGrid({page:1,pageSize:1}),e.employee=!0}catch(t){}try{await v.getCategories(),e.category=!0}catch(t){}try{await b.getTransactions(),e.transactions=!0}catch(t){}try{await w.getReportData(),e.reports=!0}catch(t){}return e}catch(s){return e}},axios:g,storage:u,downloadReport:()=>w.downloadExcelReport(),getToken:()=>u.getToken(),clearAuth:()=>E()},T="test@example.com",C="Test@1234";const L=new class{constructor(){this.currentUser=null,this.isAuthenticated=!1,this.tokenExpiryTimer=null}init(){const e=u.getToken(),t=u.getUser();e&&t&&(this.currentUser=t,this.isAuthenticated=!0,this.startTokenExpiryCheck(),window.EventBus&&window.EventBus.emit("auth:initialized",{user:t}))}async login(e,t,s=!1){var a;try{const s=await S.auth.login(e,t);if(s.isSuccess&&(null==(a=s.data)?void 0:a.token))return this.handleLoginSuccess(s.data);throw new Error(s.message||"Login failed")}catch(n){throw window.EventBus&&window.EventBus.emit("auth:login-failed",n),n}}handleLoginSuccess(e){const{token:t,user:s}=e;return u.setToken(t),u.setUser(s),this.currentUser=s,this.isAuthenticated=!0,this.startTokenExpiryCheck(),window.EventBus&&window.EventBus.emit("auth:login-success",{user:s}),{isSuccess:!0,user:s,token:t,message:"Login successful"}}async logout(){try{return u.clearAuth(),this.currentUser=null,this.isAuthenticated=!1,this.stopTokenExpiryCheck(),window.EventBus&&window.EventBus.emit("auth:logout"),{isSuccess:!0,message:"Logged out successfully"}}catch(e){throw e}}async getMe(){try{const e=await S.auth.getMe();if(e.isSuccess&&e.data)return u.setUser(e.data),this.currentUser=e.data,e.data;throw new Error(e.message||"Failed to get user data")}catch(e){throw e}}async changePassword(e,t,s){try{const a=await S.auth.changePassword({oldPassword:e,newPassword:t,confirmPassword:s});if(a.isSuccess)return window.EventBus&&window.EventBus.emit("auth:password-changed"),a;throw new Error(a.message||"Failed to change password")}catch(a){throw a}}async forgotPassword(e){try{const t=await S.auth.forgotPassword(e);if(t.isSuccess)return window.EventBus&&window.EventBus.emit("auth:forgot-password-sent",{email:e}),t;throw new Error(t.message||"Failed to send forgot password request")}catch(t){throw t}}async resetPassword(e,t,s){try{const a=await S.auth.resetPassword({currentPassword:e,newPassword:t,confirmPassword:s});if(a.isSuccess)return window.EventBus&&window.EventBus.emit("auth:password-reset-success"),a;throw new Error(a.message||"Failed to reset password")}catch(a){throw a}}async resetPasswordWithToken(e,t,s,a){try{const n=await S.auth.resetPasswordWithToken({email:e,resetToken:t,newPassword:s,confirmPassword:a});if(n.isSuccess)return n;throw new Error(n.message||"Failed to reset password with token")}catch(n){throw n}}getCurrentUser(){return this.currentUser||(this.currentUser=u.getUser()),this.currentUser}updateCurrentUser(e){this.currentUser={...this.currentUser,...e},u.setUser(this.currentUser),window.EventBus&&window.EventBus.emit("auth:user-updated",this.currentUser)}checkAuth(){const e=u.getToken(),t=u.getUser();return this.isAuthenticated=!(!e||!t),this.isAuthenticated}isTestAccount(){const e=this.getCurrentUser();return(null==e?void 0:e.email)===T}hasPermission(e){const t=this.getCurrentUser();if(!t)return!1;const s={admin:["*","create","read","update","delete","manage_users"],manager:["create","read","update","manage_assets"],user:["read"]}[t.roleId||t.role]||["read"];return!!s.includes("*")||(s.includes(e)||!1)}hasRole(e){const t=this.getCurrentUser();return((null==t?void 0:t.roleId)||(null==t?void 0:t.role))===e}clearAuthData(){u.clearAuth(),this.currentUser=null,this.isAuthenticated=!1,this.stopTokenExpiryCheck()}startTokenExpiryCheck(){this.stopTokenExpiryCheck(),this.tokenExpiryTimer=setInterval(()=>{this.checkAuth()||(this.clearAuthData(),window.EventBus&&window.EventBus.emit("auth:session-expired"))},3e5)}stopTokenExpiryCheck(){this.tokenExpiryTimer&&(clearInterval(this.tokenExpiryTimer),this.tokenExpiryTimer=null)}async validateToken(){try{return await this.getMe(),!0}catch(e){if(401===e.status)return this.clearAuthData(),!1;throw e}}lockScreen(){u.setTempData("screen_locked",!0),window.EventBus&&window.EventBus.emit("auth:screen-locked")}async unlockScreen(e){try{const t=this.getCurrentUser();if(this.isTestAccount()&&e===C)return u.removeTempData("screen_locked"),window.EventBus&&window.EventBus.emit("auth:screen-unlocked"),{isSuccess:!0};if(t)return u.removeTempData("screen_locked"),window.EventBus&&window.EventBus.emit("auth:screen-unlocked"),{isSuccess:!0};throw new Error("Invalid credentials")}catch(t){throw t}}isScreenLocked(){return!0===u.getTempData("screen_locked")}canAccessRoute(e){const t=this.getCurrentUser();if(!t)return!1;const s={admin:["*"],manager:["dashboard","assets","employees","categories","transactions"],user:["dashboard","assets"]}[t.roleId||t.role]||["dashboard"];return!!s.includes("*")||s.includes(e)}};L.init();const B=new class{constructor(){this.events={}}on(e,t){return this.events[e]||(this.events[e]=[]),this.events[e].push(t),()=>this.off(e,t)}once(e,t){const s=(...a)=>{t(...a),this.off(e,s)};this.on(e,s)}off(e,t){this.events[e]&&(this.events[e]=this.events[e].filter(e=>e!==t),0===this.events[e].length&&delete this.events[e])}emit(e,t){this.events[e]&&this.events[e].forEach(e=>{try{e(t)}catch(s){}})}getEvents(){return Object.keys(this.events)}clear(){this.events={}}clearEvent(e){delete this.events[e]}listenerCount(e){return this.events[e]?this.events[e].length:0}};class A{static createElement(e,t={},s=""){const a=document.createElement(e);return Object.entries(t).forEach(([e,t])=>{if("className"===e)a.className=t;else if("dataset"===e)Object.entries(t).forEach(([e,t])=>{a.dataset[e]=t});else if(e.startsWith("on")){const s=e.substring(2).toLowerCase();a.addEventListener(s,t)}else a.setAttribute(e,t)}),s&&("string"==typeof s?a.textContent=s:s instanceof Node&&a.appendChild(s)),a}static qs(e,t=document){return t.querySelector(e)}static qsa(e,t=document){return Array.from(t.querySelectorAll(e))}static on(e,t,s,a){e.addEventListener(t,e=>{const t=e.target.closest(s);t&&a.call(t,e)})}static debounce(e,t=300){let s;return function(...a){clearTimeout(s),s=setTimeout(()=>{clearTimeout(s),e(...a)},t)}}static throttle(e,t=300){let s;return function(...a){s||(e(...a),s=!0,setTimeout(()=>s=!1,t))}}static sanitizeHTML(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}static insertHTML(e,t,s="beforeend"){const a=document.createElement("template");switch(a.innerHTML=t.trim(),s){case"beforebegin":e.parentNode.insertBefore(a.content,e);break;case"afterbegin":e.insertBefore(a.content,e.firstChild);break;case"beforeend":e.appendChild(a.content);break;case"afterend":e.parentNode.insertBefore(a.content,e.nextSibling)}}static remove(e){e&&e.parentNode&&e.parentNode.removeChild(e)}static toggleClass(e,t,s){void 0!==s?e.classList.toggle(t,s):e.classList.toggle(t)}static getOffset(e){const t=e.getBoundingClientRect();return{top:t.top+window.pageYOffset,left:t.left+window.pageXOffset,width:t.width,height:t.height}}static scrollTo(e,t={}){e.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest",...t})}static createFragment(e){const t=document.createElement("template");return t.innerHTML=e.trim(),t.content}static batchUpdate(e){requestAnimationFrame(()=>{e()})}static waitForElement(e,t=5e3){return new Promise((s,a)=>{const n=this.qs(e);if(n)return void s(n);const i=new MutationObserver(()=>{const t=this.qs(e);t&&(i.disconnect(),s(t))});i.observe(document.body,{childList:!0,subtree:!0}),setTimeout(()=>{i.disconnect(),a(new Error("Element ".concat(e," not found within ").concat(t,"ms")))},t)})}static isInViewport(e){const t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}static getStyle(e,t){return window.getComputedStyle(e).getPropertyValue(t)}static setStyles(e,t){Object.entries(t).forEach(([t,s])=>{e.style[t]=s})}}const k=new class{constructor(){this.routes=new Map,this.currentRoute=null,this.defaultRoute="dashboard",this.authPages=["login","register","forgot-password","reset-password"],this.isInitialized=!1}init(){this.isInitialized||(this.registerRoutes(),this.setupEventListeners(),this.handleInitialRoute(),this.isInitialized=!0)}registerRoutes(){this.register("dashboard",{title:"Dashboard",template:"pages/dashboard.html",requiresAuth:!0,onEnter:()=>this.loadDashboardData()}),this.register("profile",{title:"User Profile",template:"pages/profile.html",requiresAuth:!0}),this.register("settings",{title:"Settings",template:"pages/settings.html",requiresAuth:!0}),this.register("model1",{title:"Data Table",template:"pages/model1.html",requiresAuth:!0}),this.register("model2",{title:"Forms",template:"pages/model2.html",requiresAuth:!0}),this.register("model3",{title:"Analytics",template:"pages/model3.html",requiresAuth:!0}),this.register("employees",{title:"Employees - RedAdmin Pro",template:"pages/employees.html",requiresAuth:!0}),this.register("employeescreate",{title:"Create Employee - RedAdmin Pro",template:"pages/employeecrud.html",requiresAuth:!0,onEnter:()=>{sessionStorage.setItem("crudMode","create"),sessionStorage.setItem("crudModule","employee"),sessionStorage.removeItem("crudId")}}),this.register("employeesupdate",{title:"Update Employee - RedAdmin Pro",template:"pages/employeecrud.html",requiresAuth:!0,onEnter:()=>{sessionStorage.setItem("crudMode","update"),sessionStorage.setItem("crudModule","employee")}}),this.register("assets",{title:"Assets - RedAdmin Pro",template:"pages/assets.html",requiresAuth:!0}),this.register("assetscreate",{title:"Create Asset - RedAdmin Pro",template:"pages/assetcrud.html",requiresAuth:!0,onEnter:()=>{sessionStorage.setItem("crudMode","create"),sessionStorage.setItem("crudModule","asset"),sessionStorage.removeItem("crudId")}}),this.register("assetsupdate",{title:"Update Asset - RedAdmin Pro",template:"pages/assetcrud.html",requiresAuth:!0,onEnter:()=>{sessionStorage.setItem("crudMode","update"),sessionStorage.setItem("crudModule","asset")}}),this.register("categories",{title:"Categories - RedAdmin Pro",template:"pages/categories.html",requiresAuth:!0}),this.register("categoriescreate",{title:"Create Category - RedAdmin Pro",template:"pages/categorycrud.html",requiresAuth:!0,onEnter:()=>{sessionStorage.setItem("crudMode","create"),sessionStorage.setItem("crudModule","category"),sessionStorage.removeItem("crudId")}}),this.register("categoriesupdate",{title:"Update Category - RedAdmin Pro",template:"pages/categorycrud.html",requiresAuth:!0,onEnter:()=>{sessionStorage.setItem("crudMode","update"),sessionStorage.setItem("crudModule","category")}}),this.register("transactions",{title:"Transactions - RedAdmin Pro",template:"pages/transactions.html",requiresAuth:!0}),this.register("transactionscreate",{title:"Create Transaction - RedAdmin Pro",template:"pages/transactioncrud.html",requiresAuth:!0,onEnter:()=>{sessionStorage.setItem("crudMode","create"),sessionStorage.setItem("crudModule","transaction"),sessionStorage.removeItem("crudId")}}),this.register("transactionsupdate",{title:"Update Transaction - RedAdmin Pro",template:"pages/transactioncrud.html",requiresAuth:!0,onEnter:()=>{sessionStorage.setItem("crudMode","update"),sessionStorage.setItem("crudModule","transaction")}}),this.register("reports",{title:"Reports - RedAdmin Pro",template:"pages/reports.html",requiresAuth:!0}),this.register("file-upload",{title:"File Upload - RedAdmin Pro",template:"pages/file-upload.html",requiresAuth:!0}),this.register("components",{title:"UI Components",template:"pages/components.html",requiresAuth:!0}),this.register("buttons",{title:"Buttons",template:"pages/buttons.html",requiresAuth:!0}),this.register("login",{title:"Login",template:"pages/login.html",requiresAuth:!1,layout:"auth"}),this.register("register",{title:"Register",template:"pages/register.html",requiresAuth:!1,layout:"auth"}),this.register("forgot-password",{title:"Forgot Password",template:"pages/forgot-password.html",requiresAuth:!1,layout:"auth"}),this.register("reset-password",{title:"Reset Password",template:"pages/reset-password.html",requiresAuth:!1,layout:"auth"}),this.register("lockscreen",{title:"Lock Screen",template:"pages/lockscreen.html",requiresAuth:!1,layout:"auth"}),this.register("error404",{title:"404 Not Found",template:"pages/error404.html",requiresAuth:!1,layout:"auth"}),this.register("error500",{title:"500 Server Error",template:"pages/error500.html",requiresAuth:!1,layout:"auth"}),this.register("maintenance",{title:"Maintenance",template:"pages/maintenance.html",requiresAuth:!1,layout:"auth"})}register(e,t){this.routes.set(e,t)}setupEventListeners(){window.addEventListener("popstate",e=>{const t=this.getPathFromUrl();this.loadRoute(t)}),document.addEventListener("click",e=>{const t=e.target.closest("[data-route]");if(t){e.preventDefault();const s=t.dataset.route;this.navigate(s)}})}getPathFromUrl(){return window.location.pathname.replace(/^\//,"")||this.defaultRoute}handleInitialRoute(){const e=this.getPathFromUrl();this.routes.has(e)?this.loadRoute(e,!1):""===e||"/"===e?this.loadRoute(this.defaultRoute,!1):this.loadRoute("error404",!1)}navigate(e,t=!0){let s=!0,a=null;"boolean"==typeof t?s=t:"object"==typeof t&&(s=!1!==t.pushState,a=t.id||null),a&&sessionStorage.setItem("crudId",a),s&&window.history.pushState({path:e},"","/".concat(e)),this.loadRoute(e)}async loadRoute(e,t=!0){const s=this.routes.get(e);if(s)if(!s.requiresAuth&&L.checkAuth()&&this.authPages.includes(e))this.navigate(this.defaultRoute,t);else{B.emit("app:loading",!0);try{"auth"===s.layout?this.showAuthLayout():this.showDefaultLayout(),await this.loadTemplate(s.template),document.title="".concat(s.title," - RedAdmin Pro"),this.updateActiveMenu(e),this.currentRoute=e,s.onEnter&&await s.onEnter(),B.emit("route:changed",{path:e,route:s})}catch(a){B.emit("app:error",a)}finally{B.emit("app:loading",!1)}}else this.navigate("error404",t)}async loadTemplate(e){try{const t=await fetch("/".concat(e));if(!t.ok)throw new Error("Failed to load template: ".concat(t.status));const s=await t.text(),a=document.getElementById("pageContent");a&&(a.innerHTML=s,window.dispatchEvent(new CustomEvent("pageLoaded",{detail:{path:e}})))}catch(t){throw t}}showAuthLayout(){const e=document.querySelector(".sidebar-container"),t=document.querySelector(".topbar"),s=document.querySelector(".main-content"),a=document.querySelector(".footer");e&&(e.style.display="none"),t&&(t.style.display="none"),s&&(s.style.marginLeft="0",s.style.marginTop="0"),a&&(a.style.display="none")}showDefaultLayout(){const e=document.querySelector(".sidebar-container"),t=document.querySelector(".topbar"),s=document.querySelector(".main-content"),a=document.querySelector(".footer");e&&(e.style.display="flex"),t&&(t.style.display="flex"),s&&(s.style.marginLeft="",s.style.marginTop=""),a&&(a.style.display="block")}updateActiveMenu(e){document.querySelectorAll(".sidebar-menu a").forEach(e=>{e.classList.remove("active")});const t=document.querySelector('[data-route="'.concat(e,'"]'));t&&t.classList.add("active")}async loadDashboardData(){}getCurrentRoute(){return this.currentRoute}hasRoute(e){return this.routes.has(e)}};const D=new class{constructor(){this.state={user:null,theme:"light",sidebarCollapsed:!1,notifications:[],settings:{},cache:{}},this.subscribers=new Map,this.init()}init(){this.loadPersistedState()}loadPersistedState(){const e=u.getUser(),t=u.getItem("theme")||"light",s=u.getItem("sidebar_collapsed")||!1,a=u.getItem("settings")||{};this.state={...this.state,user:e,theme:t,sidebarCollapsed:s,settings:a}}get(e){return this.state[e]}set(e,t,s=!1){const a=this.state[e];this.state[e]=t,s&&u.setItem(e,t),this.notify(e,t,a),B.emit("state:changed",{key:e,value:t,oldValue:a})}update(e,t=!1){Object.entries(e).forEach(([e,s])=>{this.set(e,s,t)})}subscribe(e,t){return this.subscribers.has(e)||this.subscribers.set(e,[]),this.subscribers.get(e).push(t),()=>{const s=this.subscribers.get(e),a=s.indexOf(t);a>-1&&s.splice(a,1)}}notify(e,t,s){const a=this.subscribers.get(e);a&&a.forEach(e=>{try{e(t,s)}catch(a){}})}clear(e=!1){this.state={user:null,theme:"light",sidebarCollapsed:!1,notifications:[],settings:{},cache:{}},e&&u.clear(),B.emit("state:cleared")}getState(){return{...this.state}}setUser(e){this.set("user",e,!0)}getUser(){return this.get("user")}setTheme(e){this.set("theme",e,!0),document.documentElement.setAttribute("data-theme",e)}getTheme(){return this.get("theme")}toggleSidebar(){const e=!this.get("sidebarCollapsed");this.set("sidebarCollapsed",e,!0)}addNotification(e){const t=this.get("notifications");t.push(e),this.set("notifications",t)}removeNotification(e){const t=this.get("notifications").filter(t=>t.id!==e);this.set("notifications",t)}cacheData(e,t,s=36e5){const a=this.get("cache");a[e]={data:t,timestamp:Date.now(),ttl:s},this.set("cache",a)}getCachedData(e){const t=this.get("cache"),s=t[e];if(!s)return null;return Date.now()-s.timestamp>s.ttl?(delete t[e],this.set("cache",t),null):s.data}clearCache(){this.set("cache",{})}};const x=new class{constructor(){this.container=null,this.init()}init(){this.container||(this.container=document.createElement("div"),this.container.id="notification-container",this.container.className="position-fixed top-0 end-0 p-3",this.container.style.zIndex="9999",document.body.appendChild(this.container))}show(e,t,s={}){const a={duration:5e3,dismissible:!0,icon:!0,...s},n="toast-"+Date.now(),i=this.getIconClass(e),o='\n      <div class="toast align-items-center text-bg-'.concat(e,' border-0" \n           id="').concat(n,'" role="alert" aria-live="assertive" aria-atomic="true">\n        <div class="d-flex">\n          <div class="toast-body">\n            ').concat(a.icon?'<i class="'.concat(i,' me-2"></i>'):"","\n            ").concat(t,"\n          </div>\n          ").concat(a.dismissible?'\n            <button type="button" class="btn-close btn-close-white me-2 m-auto" \n                    data-bs-dismiss="toast" aria-label="Close"></button>\n          ':"","\n        </div>\n      </div>\n    ");A.insertHTML(this.container,o);const r=document.getElementById(n),c=new bootstrap.Toast(r,{delay:a.duration});return c.show(),r.addEventListener("hidden.bs.toast",()=>{r.remove()}),c}getIconClass(e){const t={success:"fas fa-check-circle",danger:"fas fa-exclamation-circle",warning:"fas fa-exclamation-triangle",info:"fas fa-info-circle",primary:"fas fa-bell"};return t[e]||t.info}success(e,t={}){return this.show("success",e,t)}error(e,t={}){return this.show("danger",e,t)}warning(e,t={}){return this.show("warning",e,t)}info(e,t={}){return this.show("info",e,t)}clearAll(){this.container&&(this.container.innerHTML="")}};const P=new class{constructor(){this.isLocked=!1}lock(){localStorage.setItem("isLocked","true"),localStorage.setItem("lockScreenTime",(new Date).toISOString()),this.isLocked=!0,window.location.href="/lockscreen"}unlock(){localStorage.removeItem("isLocked"),localStorage.removeItem("lockScreenTime"),this.isLocked=!1,window.location.href="/dashboard"}isScreenLocked(){return"true"===localStorage.getItem("isLocked")}};class N{constructor(e={}){this.options={id:"modal-"+Date.now(),title:"",content:"",size:"md",centered:!0,backdrop:!0,keyboard:!0,footer:!0,closeButton:!0,buttons:[],onShow:null,onHide:null,onSubmit:null,...e},this.modal=null,this.bsModal=null,this.isVisible=!1}create(){const e='\n      <div class="modal fade" id="'.concat(this.options.id,'" tabindex="-1" \n           aria-labelledby="').concat(this.options.id,'Label" aria-hidden="true"\n           data-bs-backdrop="').concat(this.options.backdrop?"true":"static",'"\n           data-bs-keyboard="').concat(this.options.keyboard,'">\n        <div class="modal-dialog ').concat(this.getSizeClass()," ").concat(this.options.centered?"modal-dialog-centered":"",' modal-dialog-scrollable">\n          <div class="modal-content">\n            <div class="modal-header">\n              <h5 class="modal-title" id="').concat(this.options.id,'Label">').concat(this.options.title,"</h5>\n              ").concat(this.options.closeButton?'\n                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n              ':"",'\n            </div>\n            <div class="modal-body">\n              ').concat(this.options.content,"\n            </div>\n            ").concat(this.options.footer?this.createFooter():"","\n          </div>\n        </div>\n      </div>\n    "),t=document.getElementById("modals-container")||document.body;return A.insertHTML(t,e),this.modal=document.getElementById(this.options.id),this.setupEventListeners(),this}getSizeClass(){return{sm:"modal-sm",md:"",lg:"modal-lg",xl:"modal-xl",fullscreen:"modal-fullscreen"}[this.options.size]||""}createFooter(){if(0===this.options.buttons.length)return'\n        <div class="modal-footer">\n          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>\n        </div>\n      ';const e=this.options.buttons.map(e=>{const t=e.className||"btn-primary",s=e.dismiss?'data-bs-dismiss="modal"':"";return'\n        <button type="button" class="btn '.concat(t,'" data-action="').concat(e.action||"",'" ').concat(s,">\n          ").concat(e.text,"\n        </button>\n      ")}).join("");return'<div class="modal-footer">'.concat(e,"</div>")}setupEventListeners(){this.modal.addEventListener("show.bs.modal",()=>{this.isVisible=!0,this.options.onShow&&this.options.onShow(this),B.emit("modal:show",{id:this.options.id})}),this.modal.addEventListener("hide.bs.modal",()=>{this.isVisible=!1,this.options.onHide&&this.options.onHide(this),B.emit("modal:hide",{id:this.options.id})}),this.modal.addEventListener("hidden.bs.modal",()=>{B.emit("modal:hidden",{id:this.options.id})}),this.options.buttons.forEach(e=>{if(e.action&&e.onClick){const t=this.modal.querySelector('[data-action="'.concat(e.action,'"]'));t&&t.addEventListener("click",t=>e.onClick(t,this))}})}show(){return this.modal||this.create(),this.bsModal||(this.bsModal=new bootstrap.Modal(this.modal,{backdrop:this.options.backdrop,keyboard:this.options.keyboard})),this.bsModal.show(),this}hide(){return this.bsModal&&this.bsModal.hide(),this}destroy(){return this.bsModal&&this.bsModal.dispose(),this.modal&&this.modal.remove(),this.modal=null,this.bsModal=null,this}updateContent(e){const t=this.modal.querySelector(".modal-body");return t&&(t.innerHTML=e),this}updateTitle(e){const t=this.modal.querySelector(".modal-title");return t&&(t.textContent=e),this}toggle(){return this.isVisible?this.hide():this.show(),this}getElement(){return this.modal}getInstance(){return this.bsModal}}const M=new class{constructor(){this.modals=new Map}create(e){const t=new N(e);return this.modals.set(e.id||t.options.id,t),t}get(e){return this.modals.get(e)}show(e){const t=this.modals.get(e);t&&t.show()}hide(e){const t=this.modals.get(e);t&&t.hide()}destroy(e){const t=this.modals.get(e);t&&(t.destroy(),this.modals.delete(e))}destroyAll(){this.modals.forEach(e=>e.destroy()),this.modals.clear()}hideAll(){this.modals.forEach(e=>e.hide())}getActive(){for(const[e,t]of this.modals)if(t.isVisible)return t;return null}};const R=new class{constructor(){this.messages=[],this.currentPage=1,this.perPage=10,this.totalPages=0,this.modal=null}show(e=[]){if(e.length>0?this.messages=e:0===this.messages.length&&(this.messages=this.generateSampleMessages()),this.totalPages=Math.ceil(this.messages.length/this.perPage),this.modal&&document.getElementById("inboxModal")){const e=document.querySelector("#inboxModal .modal-body");e&&(e.innerHTML=this.renderInbox(),this.setupInboxHandlers())}else this.modal=M.create({id:"inboxModal",title:"Inbox",size:"lg",content:this.renderInbox(),footer:!1,onShow:()=>{this.setupInboxHandlers()}});this.modal.show()}renderInbox(){const e=(this.currentPage-1)*this.perPage,t=e+this.perPage,s=this.messages.slice(e,t);return'\n      <div class="inbox-container">\n        <div class="inbox-header mb-3">\n          <div class="input-group">\n            <span class="input-group-text">\n              <i class="fas fa-search"></i>\n            </span>\n            <input type="text" class="form-control" \n                   id="inboxSearch" \n                   placeholder="Search messages...">\n          </div>\n        </div>\n        \n        <div class="inbox-list">\n          '.concat(s.map(e=>this.renderMessage(e)).join(""),"\n        </div>\n        \n        ").concat(this.renderPagination(),"\n      </div>\n    ")}renderMessage(e){const t=e.unread?"unread":"",s=e.avatar||"https://via.placeholder.com/40";return'\n      <div class="inbox-message '.concat(t,'" data-message-id="').concat(e.id,'">\n        <div class="message-avatar">\n          <img src="').concat(s,'" alt="').concat(e.from,'">\n        </div>\n        <div class="message-content">\n          <div class="message-header">\n            <strong>').concat(e.from,'</strong>\n            <small class="text-muted">').concat(e.time,'</small>\n          </div>\n          <div class="message-subject">').concat(e.subject,'</div>\n          <div class="message-preview">').concat(e.preview,'</div>\n        </div>\n        <div class="message-actions">\n          ').concat(e.unread?'<span class="badge bg-primary">New</span>':"","\n        </div>\n      </div>\n    ")}renderPagination(){if(this.totalPages<=1)return"";const e=[];for(let t=1;t<=this.totalPages;t++)e.push('\n        <li class="page-item '.concat(t===this.currentPage?"active":"",'">\n          <button class="page-link" data-page="').concat(t,'">').concat(t,"</button>\n        </li>\n      "));return'\n      <nav class="mt-3">\n        <ul class="pagination justify-content-center">\n          <li class="page-item '.concat(1===this.currentPage?"disabled":"",'">\n            <button class="page-link" data-page="prev">Previous</button>\n          </li>\n          ').concat(e.join(""),'\n          <li class="page-item ').concat(this.currentPage===this.totalPages?"disabled":"",'">\n            <button class="page-link" data-page="next">Next</button>\n          </li>\n        </ul>\n      </nav>\n    ')}setupInboxHandlers(){const e=this.modal.getElement(),t=e.querySelector("#inboxSearch");t&&t.addEventListener("input",A.debounce(e=>{this.handleSearch(e.target.value)},300)),A.on(e,"click",".inbox-message",e=>{const t=e.currentTarget.dataset.messageId;this.openMessage(t)}),A.on(e,"click",".page-link",e=>{const t=e.currentTarget.dataset.page;this.currentPage="prev"===t?Math.max(1,this.currentPage-1):"next"===t?Math.min(this.totalPages,this.currentPage+1):parseInt(t),this.updateInbox()})}handleSearch(e){B.emit("inbox:search",{query:e})}openMessage(e){const t=this.messages.find(t=>t.id==e);t&&(t.unread=!1,B.emit("inbox:message-opened",{message:t}),B.emit("notification:info","Opening message from ".concat(t.from)))}updateInbox(){const e=this.renderInbox();this.modal.updateContent(e),this.setupInboxHandlers()}generateSampleMessages(){const e=[];for(let t=1;t<=25;t++)e.push({id:t,from:"User ".concat(t),subject:"Message Subject ".concat(t),preview:"This is a preview of message ".concat(t,"..."),time:"".concat(t," hours ago"),unread:t<=5,avatar:null});return e}hide(){this.modal&&this.modal.hide()}};const F=new class{constructor(){this.recentSearches=this.loadRecentSearches(),this.pages=[{name:"Dashboard",path:"/dashboard",icon:"home",category:"Main"},{name:"Profile",path:"/profile",icon:"user",category:"Main"},{name:"Settings",path:"/settings",icon:"cog",category:"Main"},{name:"Employees",path:"/employees",icon:"users",category:"Data"},{name:"Assets",path:"/assets",icon:"box",category:"Data"},{name:"Categories",path:"/categories",icon:"tags",category:"Data"},{name:"Transactions",path:"/transactions",icon:"exchange-alt",category:"Data"},{name:"Data Table",path:"/model1",icon:"table",category:"Pages"},{name:"Forms",path:"/model2",icon:"edit",category:"Pages"},{name:"Analytics",path:"/model3",icon:"chart-bar",category:"Pages"},{name:"Reports",path:"/reports",icon:"chart-line",category:"Pages"},{name:"File Upload",path:"/file-upload",icon:"cloud-upload-alt",category:"Pages"},{name:"Components",path:"/components",icon:"th-large",category:"UI"},{name:"Buttons",path:"/buttons",icon:"mouse-pointer",category:"UI"}],this.init()}init(){this.createModal(),this.setupEventListeners()}loadRecentSearches(){const e=localStorage.getItem("recentSearches");return e?JSON.parse(e):[]}saveRecentSearches(){localStorage.setItem("recentSearches",JSON.stringify(this.recentSearches))}addToRecent(e){this.recentSearches=this.recentSearches.filter(t=>t!==e),this.recentSearches.unshift(e),this.recentSearches=this.recentSearches.slice(0,5),this.saveRecentSearches()}createModal(){const e=document.getElementById("searchModal");e&&e.remove(),document.body.insertAdjacentHTML("beforeend",'\n      <div class="modal fade" id="searchModal" tabindex="-1">\n        <div class="modal-dialog modal-dialog-centered">\n          <div class="modal-content search-modal-content">\n            <div class="search-modal-header">\n              <h6 class="text-white mb-3 d-flex align-items-center">\n                <i class="fas fa-bolt me-2"></i>Quick Links\n              </h6>\n              <div class="quick-links-grid mb-3">\n                <a href="/dashboard" class="quick-link-item" data-page="dashboard">\n                  <i class="fas fa-home"></i>\n                  <span>Dashboard</span>\n                </a>\n                <a href="/employees" class="quick-link-item" data-page="employees">\n                  <i class="fas fa-users"></i>\n                  <span>Employees</span>\n                </a>\n                <a href="/assets" class="quick-link-item" data-page="assets">\n                  <i class="fas fa-box"></i>\n                  <span>Assets</span>\n                </a>\n                <a href="/reports" class="quick-link-item" data-page="reports">\n                  <i class="fas fa-chart-line"></i>\n                  <span>Reports</span>\n                </a>\n                <a href="/profile" class="quick-link-item" data-page="profile">\n                  <i class="fas fa-user"></i>\n                  <span>Profile</span>\n                </a>\n                <a href="/settings" class="quick-link-item" data-page="settings">\n                  <i class="fas fa-cog"></i>\n                  <span>Settings</span>\n                </a>\n              </div>\n              <div class="search-input-wrapper">\n                <i class="fas fa-search search-icon"></i>\n                <input \n                  type="text" \n                  class="search-input" \n                  id="searchInput" \n                  placeholder="Search pages, menus..." \n                  autocomplete="off"\n                />\n                <button class="search-close" data-bs-dismiss="modal">\n                  <i class="fas fa-times"></i>\n                </button>\n              </div>\n            </div>\n            \n            <div class="search-modal-body">\n              \x3c!-- Recent Searches --\x3e\n              <div class="search-section" id="recentSection" style="display: none;">\n                <h6 class="search-section-title">\n                  <i class="fas fa-clock me-2"></i>Recent Searches\n                </h6>\n                <div id="recentSearches"></div>\n              </div>\n\n              \x3c!-- Search Results --\x3e\n              <div class="search-section" id="resultsSection" style="display: none;">\n                <h6 class="search-section-title">\n                  <i class="fas fa-search me-2"></i>Search Results\n                </h6>\n                <div id="searchResults"></div>\n              </div>\n\n              \x3c!-- No Results --\x3e\n              <div class="search-section" id="noResults" style="display: none;">\n                <div class="no-results">\n                  <i class="fas fa-search fa-3x mb-3 text-muted"></i>\n                  <p>No results found</p>\n                </div>\n              </div>\n            </div>\n\n            <div class="search-modal-footer">\n              <div class="search-hints">\n                <kbd>â†µ</kbd> to select\n                <kbd>ESC</kbd> to close\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    ')}setupEventListeners(){const e=document.getElementById("searchInput"),t=document.getElementById("searchModal");e&&(e.addEventListener("input",e=>{const t=e.target.value.trim();this.performSearch(t)}),e.addEventListener("keydown",e=>{if("Enter"===e.key){const e=document.querySelector(".search-result-item");e&&e.click()}})),t&&(t.addEventListener("shown.bs.modal",()=>{e.value="",e.focus(),this.showRecent()}),t.addEventListener("hidden.bs.modal",()=>{e.value="",this.hideResults()})),document.addEventListener("click",e=>{const s=e.target.closest(".quick-link-item");if(s){e.preventDefault();if(s.dataset.page){const e=bootstrap.Modal.getInstance(t);e&&e.hide(),window.location.href=s.href}}}),document.addEventListener("click",e=>{const s=e.target.closest(".search-result-item");if(s){e.preventDefault();if(s.dataset.page){this.addToRecent(s.textContent.trim());const e=bootstrap.Modal.getInstance(t);e&&e.hide(),window.location.href=s.dataset.path}}})}performSearch(e){const t=document.getElementById("resultsSection"),s=document.getElementById("recentSection"),a=document.getElementById("noResults");if(!e)return void this.showRecent();const n=this.pages.filter(t=>t.name.toLowerCase().includes(e.toLowerCase())||t.category.toLowerCase().includes(e.toLowerCase()));if(s.style.display="none",n.length>0){a.style.display="none",t.style.display="block";const e=n.map(e=>'\n        <a href="'.concat(e.path,'" class="search-result-item" data-page="').concat(e.name,'" data-path="').concat(e.path,'">\n          <i class="fas fa-').concat(e.icon,' me-3"></i>\n          <div class="result-info">\n            <div class="result-name">').concat(e.name,'</div>\n            <div class="result-category">').concat(e.category,"</div>\n          </div>\n        </a>\n      ")).join("");document.getElementById("searchResults").innerHTML=e}else t.style.display="none",a.style.display="block"}showRecent(){const e=document.getElementById("recentSection"),t=document.getElementById("resultsSection"),s=document.getElementById("noResults");if(t.style.display="none",s.style.display="none",this.recentSearches.length>0){e.style.display="block";const t=this.recentSearches.map(e=>'\n        <div class="recent-item">\n          <i class="fas fa-clock me-2"></i>\n          <span>'.concat(e,"</span>\n        </div>\n      ")).join("");document.getElementById("recentSearches").innerHTML=t}else e.style.display="none"}hideResults(){document.getElementById("resultsSection").style.display="none",document.getElementById("noResults").style.display="none",document.getElementById("recentSection").style.display="none"}show(){this.modalInstance||(this.modalInstance=new bootstrap.Modal(document.getElementById("searchModal"),{backdrop:!0,keyboard:!0}));const e=document.getElementById("searchInput");e&&(e.value=""),this.modalInstance.show(),setTimeout(()=>{e&&e.focus()},300)}};const z=new class{constructor(){this.sidebar=null,this.isCollapsed=!1,this.init()}init(){this.sidebar=document.querySelector(".sidebar-container"),this.setupEventListeners(),this.restoreSidebarState()}restoreSidebarState(){const e=localStorage.getItem("sidebarCollapsed");null!==e?(this.isCollapsed="true"===e,this.sidebar&&(this.isCollapsed?(this.sidebar.classList.add("collapsed"),document.body.classList.add("sidebar-collapsed")):(this.sidebar.classList.remove("collapsed"),document.body.classList.remove("sidebar-collapsed")))):this.checkInitialState()}checkInitialState(){this.sidebar&&(this.isCollapsed=this.sidebar.classList.contains("collapsed"))}saveSidebarState(){localStorage.setItem("sidebarCollapsed",this.isCollapsed.toString())}setupEventListeners(){document.addEventListener("click",e=>{e.target.closest(".menu-toggle")&&setTimeout(()=>{this.isCollapsed=this.sidebar.classList.contains("collapsed"),this.saveSidebarState()},100)}),document.addEventListener("click",e=>{e.target.closest(".sidebar-menu a:not(.submenu-toggle)")&&this.isCollapsed&&window.innerWidth>=1024&&(this.sidebar.classList.remove("collapsed"),document.body.classList.remove("sidebar-collapsed"),this.isCollapsed=!1)}),document.addEventListener("click",e=>{const t=e.target.closest(".submenu-toggle");t&&this.isCollapsed&&window.innerWidth>=1024&&(e.preventDefault(),this.sidebar.classList.remove("collapsed"),document.body.classList.remove("sidebar-collapsed"),this.isCollapsed=!1,setTimeout(()=>{const e=t.parentElement,s=e.querySelector(".submenu");e.classList.contains("open")?(e.classList.remove("open"),s.classList.remove("show")):(document.querySelectorAll(".sidebar-menu .has-submenu").forEach(t=>{var s;t!==e&&(t.classList.remove("open"),null==(s=t.querySelector(".submenu"))||s.classList.remove("show"))}),e.classList.add("open"),s.classList.add("show"))},300))})}};const q=new class{constructor(){this.notifications=this.loadNotifications(),this.init()}init(){this.createModal()}loadNotifications(){return[{id:1,type:"success",icon:"check-circle",title:"Task Completed",message:"Your report has been successfully generated and is ready for download.",time:"5 minutes ago",read:!1},{id:2,type:"info",icon:"info-circle",title:"System Update",message:"A new system update is available. Please update to get the latest features.",time:"1 hour ago",read:!1},{id:3,type:"warning",icon:"exclamation-triangle",title:"Storage Warning",message:"Your storage is almost full. Consider upgrading your plan or removing old files.",time:"2 hours ago",read:!0},{id:4,type:"primary",icon:"user-plus",title:"New Team Member",message:"John Doe has joined your team. Welcome them aboard!",time:"3 hours ago",read:!0},{id:5,type:"danger",icon:"exclamation-circle",title:"Security Alert",message:"Unusual login activity detected from a new device. Please verify if this was you.",time:"1 day ago",read:!0}]}createModal(){const e='\n      <div class="modal fade" id="notificationModal" tabindex="-1" aria-hidden="true">\n        <div class="modal-dialog modal-dialog-scrollable">\n          <div class="modal-content">\n            <div class="modal-header">\n              <h5 class="modal-title">\n                <i class="fas fa-bell me-2"></i>Notifications\n                <span class="badge bg-danger ms-2" id="notifCount">'.concat(this.getUnreadCount(),'</span>\n              </h5>\n              <button type="button" class="btn-close" data-bs-dismiss="modal"></button>\n            </div>\n            <div class="modal-body p-0">\n              <div class="notification-list" id="notificationList">\n                ').concat(this.renderNotifications(),'\n              </div>\n            </div>\n            <div class="modal-footer">\n              <button type="button" class="btn btn-sm btn-outline-secondary" onclick="notificationModal.markAllRead()">\n                <i class="fas fa-check-double me-1"></i>Mark All Read\n              </button>\n              <button type="button" class="btn btn-sm btn-outline-danger" onclick="notificationModal.clearAll()">\n                <i class="fas fa-trash me-1"></i>Clear All\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    ');document.getElementById("notificationModal")||document.body.insertAdjacentHTML("beforeend",e)}renderNotifications(){return 0===this.notifications.length?'\n        <div class="text-center py-5">\n          <i class="fas fa-inbox fa-3x text-muted mb-3"></i>\n          <p class="text-muted">No notifications</p>\n        </div>\n      ':this.notifications.map(e=>'\n      <div class="notification-item '.concat(e.read?"read":"unread",'" data-id="').concat(e.id,'">\n        <div class="notif-icon bg-').concat(e.type,'">\n          <i class="fas fa-').concat(e.icon,'"></i>\n        </div>\n        <div class="notif-content">\n          <h6 class="notif-title">').concat(e.title,'</h6>\n          <p class="notif-message">').concat(e.message,'</p>\n          <small class="notif-time">\n            <i class="fas fa-clock me-1"></i>').concat(e.time,'\n          </small>\n        </div>\n        <div class="notif-actions">\n          <button class="btn btn-sm btn-link" onclick="notificationModal.markRead(').concat(e.id,')" title="Mark as read">\n            <i class="fas fa-check"></i>\n          </button>\n          <button class="btn btn-sm btn-link text-danger" onclick="notificationModal.remove(').concat(e.id,')" title="Delete">\n            <i class="fas fa-times"></i>\n          </button>\n        </div>\n      </div>\n    ')).join("")}show(){document.getElementById("notificationModal")?this.refresh():this.createModal(),this.modalInstance||(this.modalInstance=new bootstrap.Modal(document.getElementById("notificationModal"),{backdrop:!0,keyboard:!0})),this.modalInstance.show()}refresh(){const e=document.getElementById("notificationList"),t=document.getElementById("notifCount");e&&(e.innerHTML=this.renderNotifications()),t&&(t.textContent=this.getUnreadCount())}getUnreadCount(){return this.notifications.filter(e=>!e.read).length}markRead(e){const t=this.notifications.find(t=>t.id===e);t&&(t.read=!0,this.refresh())}markAllRead(){this.notifications.forEach(e=>e.read=!0),this.refresh()}remove(e){this.notifications=this.notifications.filter(t=>t.id!==e),this.refresh()}clearAll(){confirm("Are you sure you want to clear all notifications?")&&(this.notifications=[],this.refresh())}refresh(){const e=document.getElementById("notificationList"),t=document.getElementById("notifCount");if(e&&(e.innerHTML=this.renderNotifications()),t){const e=this.getUnreadCount();t.textContent=e,t.style.display=e>0?"inline-block":"none"}const s=document.querySelector(".topbar-icon .notification-badge");if(s){const e=this.getUnreadCount();s.textContent=e,s.style.display=e>0?"flex":"none"}}};"undefined"!=typeof window&&(window.notificationModal=q);const O=new class{constructor(){this.modal=null,this.resolveCallback=null,this.init()}init(){this.createModal()}createModal(){const e=document.getElementById("confirmModal");e&&e.remove(),document.body.insertAdjacentHTML("beforeend",'\n      <div class="modal fade" id="confirmModal" tabindex="-1">\n        <div class="modal-dialog modal-dialog-centered">\n          <div class="modal-content confirm-modal-content">\n            <div class="modal-body text-center p-4">\n              <div class="confirm-icon mb-3" id="confirmIcon">\n                <i class="fas fa-question-circle fa-4x"></i>\n              </div>\n              <h4 class="confirm-title mb-2" id="confirmTitle">Confirm Action</h4>\n              <p class="confirm-message text-muted" id="confirmMessage">\n                Are you sure you want to proceed?\n              </p>\n            </div>\n            <div class="modal-footer justify-content-center border-0 pt-0 pb-4">\n              <button type="button" class="btn btn-secondary px-4" data-bs-dismiss="modal" id="confirmCancel">\n                Cancel\n              </button>\n              <button type="button" class="btn btn-primary px-4" id="confirmOk">\n                Confirm\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    '),this.modal=document.getElementById("confirmModal"),this.setupEventListeners()}setupEventListeners(){const e=document.getElementById("confirmOk"),t=document.getElementById("confirmCancel");e.addEventListener("click",()=>{this.resolveCallback&&this.resolveCallback(!0),bootstrap.Modal.getInstance(this.modal).hide()}),t.addEventListener("click",()=>{this.resolveCallback&&this.resolveCallback(!1)}),this.modal.addEventListener("hidden.bs.modal",()=>{this.resolveCallback&&(this.resolveCallback(!1),this.resolveCallback=null)})}show(e={}){const{type:t="confirm",title:s="Confirm Action",message:a="Are you sure?",okText:n="Confirm",cancelText:i="Cancel",okClass:o="btn-primary"}=e;return new Promise(e=>{this.resolveCallback=e;const r=document.getElementById("confirmIcon"),c=document.getElementById("confirmOk"),l=document.getElementById("confirmCancel");let d="",h="";switch(t){case"success":d='<i class="fas fa-check-circle fa-4x"></i>',h="text-success",c.className="btn btn-success px-4",l.style.display="none";break;case"error":d='<i class="fas fa-times-circle fa-4x"></i>',h="text-danger",c.className="btn btn-danger px-4",c.textContent="OK",l.style.display="none";break;case"warning":d='<i class="fas fa-exclamation-triangle fa-4x"></i>',h="text-warning",c.className="btn btn-warning px-4",l.style.display="inline-block";break;case"delete":d='<i class="fas fa-trash-alt fa-4x"></i>',h="text-danger",c.className="btn btn-danger px-4",c.textContent="Delete",l.style.display="inline-block";break;case"info":d='<i class="fas fa-info-circle fa-4x"></i>',h="text-info",c.className="btn btn-info px-4",l.style.display="none";break;default:d='<i class="fas fa-question-circle fa-4x"></i>',h="text-primary",c.className="btn ".concat(o," px-4"),l.style.display="inline-block"}r.innerHTML=d,r.className="confirm-icon mb-3 ".concat(h),document.getElementById("confirmTitle").textContent=s,document.getElementById("confirmMessage").textContent=a,c.textContent=n,l.textContent=i;new bootstrap.Modal(this.modal).show()})}async success(e,t="Operation completed successfully!"){return await this.show({type:"success",title:e,message:t,okText:"OK"})}async error(e,t="An error occurred."){return await this.show({type:"error",title:e,message:t,okText:"OK"})}async warning(e,t="Please confirm this action."){return await this.show({type:"warning",title:e,message:t,okText:"Proceed",cancelText:"Cancel"})}async delete(e="Delete Confirmation",t="This action cannot be undone."){return await this.show({type:"delete",title:e,message:t,okText:"Delete",cancelText:"Cancel"})}async confirm(e,t){return await this.show({type:"confirm",title:e,message:t,okText:"Confirm",cancelText:"Cancel"})}async info(e,t){return await this.show({type:"info",title:e,message:t,okText:"OK"})}},H=Object.freeze(Object.defineProperty({__proto__:null,confirmModal:O},Symbol.toStringTag,{value:"Module"}));const U=document.createElement("style");U.textContent="\n    .loading-spinner-overlay {\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(0, 0, 0, 0.7);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        z-index: 9999;\n    }\n\n    .loading-spinner-container {\n        text-align: center;\n    }\n",document.head.appendChild(U);const _=new class{constructor(){this.spinner=null}show(e="Loading...",t="body"){this.hide();const s='\n            <div class="loading-spinner-overlay" id="loadingSpinner">\n                <div class="loading-spinner-container">\n                    <div class="spinner-border text-danger" role="status" style="width: 3rem; height: 3rem;">\n                        <span class="visually-hidden">Loading...</span>\n                    </div>\n                    <p class="mt-3 mb-0 text-white">'.concat(e,"</p>\n                </div>\n            </div>\n        "),a=document.querySelector(t);a&&(a.insertAdjacentHTML("beforeend",s),this.spinner=document.getElementById("loadingSpinner"))}hide(){if(this.spinner)this.spinner.remove(),this.spinner=null;else{const e=document.getElementById("loadingSpinner");e&&e.remove()}}showInline(e,t="sm"){const s=document.querySelector(e);if(!s)return;const a='\n            <span class="spinner-border '.concat("sm"===t?"spinner-border-sm":"",' text-danger inline-spinner" role="status">\n                <span class="visually-hidden">Loading...</span>\n            </span>\n        ');s.insertAdjacentHTML("beforeend",a)}hideInline(e){const t=document.querySelector(e);if(!t)return;const s=t.querySelector(".inline-spinner");s&&s.remove()}};"undefined"!=typeof window&&(window.loadingSpinner=_);const j=new class{show(e,t={}){const s={icon:"fa-inbox",title:"No Data Available",message:"There are no items to display",action:null,...t},a='\n            <div class="empty-state text-center py-5">\n                <div class="empty-state-icon mb-3">\n                    <i class="fas '.concat(s.icon,' fa-4x text-muted opacity-50"></i>\n                </div>\n                <h4 class="empty-state-title">').concat(s.title,'</h4>\n                <p class="empty-state-message text-muted">').concat(s.message,"</p>\n                ").concat(s.action?'\n                    <button class="btn btn-primary mt-3" id="emptyStateAction">\n                        <i class="fas fa-plus me-2"></i>'.concat(s.action.text,"\n                    </button>\n                "):"","\n            </div>\n        "),n=document.querySelector(e);if(n&&(n.innerHTML=a,s.action)){const e=document.getElementById("emptyStateAction");e&&e.addEventListener("click",s.action.onclick)}}hide(e){const t=document.querySelector(e);if(t){const e=t.querySelector(".empty-state");e&&e.remove()}}};"undefined"!=typeof window&&(window.emptyState=j),function(){function e(){document.querySelectorAll('.password-toggle-btn, [data-toggle="password"], .toggle-password').forEach(e=>{e.removeAttribute("onclick"),e.addEventListener("click",function(e){e.preventDefault(),window.togglePasswordVisibility(this)})})}if(window.togglePasswordVisibility=function(e){const t=e.closest(".input-group"),s=t?t.querySelector('input[type="password"], input[type="text"]'):e.previousElementSibling;if(!s)return;const a=e.querySelector("i")||e.querySelector(".fa-eye, .fa-eye-slash");"password"===s.type?(s.type="text",a&&(a.classList.remove("fa-eye"),a.classList.add("fa-eye-slash"))):(s.type="password",a&&(a.classList.remove("fa-eye-slash"),a.classList.add("fa-eye")))},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e(),"undefined"!=typeof MutationObserver){const t=new MutationObserver(t=>{t.forEach(t=>{t.addedNodes.length>0&&e()})});"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{t.observe(document.body,{childList:!0,subtree:!0})}):t.observe(document.body,{childList:!0,subtree:!0})}}();const V=new class{constructor(){this.chartInstances={},this.currentPeriod="week"}initialize(){this.generateStatsCards(),this.generateActivityTimeline(),this.generateRecentOrders(),this.generateTopProducts(),this.generatePerformanceMetrics(),"undefined"!=typeof Chart&&this.initializeCharts(),this.setupEventListeners()}setupEventListeners(){const e=document.getElementById("btnRefreshDashboard");e&&e.addEventListener("click",()=>{this.refreshDashboard()});const t=document.getElementById("btnExportReport");t&&t.addEventListener("click",()=>{this.exportReport()});const s=document.querySelectorAll("[data-period]");s.forEach(e=>{e.addEventListener("click",e=>{s.forEach(e=>e.classList.remove("active")),e.target.classList.add("active"),this.currentPeriod=e.target.dataset.period,this.updateSalesChart()})})}generateStatsCards(){const e=document.getElementById("statsCardsContainer");if(!e)return;const t=[{title:"Total Revenue",value:"$54,239",change:"+12.5%",trend:"up",icon:"dollar-sign",color:"primary"},{title:"Total Orders",value:"1,847",change:"+8.2%",trend:"up",icon:"shopping-cart",color:"success"},{title:"New Customers",value:"423",change:"-3.1%",trend:"down",icon:"users",color:"warning"},{title:"Conversion Rate",value:"3.24%",change:"+0.8%",trend:"up",icon:"chart-line",color:"info"}].map(e=>'\n            <div class="col-lg-3 col-md-6 mb-4">\n                <div class="card stat-card h-100">\n                    <div class="card-body">\n                        <div class="d-flex justify-content-between align-items-center mb-3">\n                            <div class="stat-icon bg-'.concat(e.color,'">\n                                <i class="fas fa-').concat(e.icon,'"></i>\n                            </div>\n                            <span class="stat-change ').concat("up"===e.trend?"text-success":"text-danger",'">\n                                <i class="fas fa-arrow-').concat(e.trend,'"></i> ').concat(e.change,'\n                            </span>\n                        </div>\n                        <h6 class="text-muted mb-2">').concat(e.title,'</h6>\n                        <h3 class="mb-0">').concat(e.value,"</h3>\n                    </div>\n                </div>\n            </div>\n        ")).join("");e.innerHTML=t}generateActivityTimeline(){const e=document.getElementById("activityTimeline"),t=document.getElementById("activityCount");if(!e)return;const s=[{icon:"box",color:"success",title:"New Asset Added",detail:"Laptop Dell XPS 15 has been registered",time:"2 mins ago"},{icon:"user-check",color:"primary",title:"Asset Checked Out",detail:"John Doe checked out Projector Epson",time:"15 mins ago"},{icon:"tools",color:"warning",title:"Maintenance Scheduled",detail:"AC Unit #5 maintenance tomorrow",time:"30 mins ago"},{icon:"exchange-alt",color:"info",title:"Asset Transferred",detail:"Monitor moved from IT to Marketing",time:"1 hour ago"},{icon:"check-circle",color:"success",title:"Asset Returned",detail:"Camera Canon returned by Jane Smith",time:"2 hours ago"},{icon:"exclamation-triangle",color:"danger",title:"Low Stock Alert",detail:"Only 3 USB cables remaining",time:"3 hours ago"}];t&&(t.textContent=s.length);let a="";s.forEach((e,t)=>{a+='\n                <div class="timeline-item '.concat(t===s.length-1?"last":"",'">\n                    <div class="timeline-dot bg-').concat(e.color,'">\n                        <i class="fas fa-').concat(e.icon,'"></i>\n                    </div>\n                    <div class="timeline-card">\n                        <div class="timeline-header">\n                            <strong class="timeline-title">').concat(e.title,'</strong>\n                            <small class="timeline-time">').concat(e.time,'</small>\n                        </div>\n                        <p class="timeline-detail mb-0">').concat(e.detail,"</p>\n                    </div>\n                </div>\n            ")}),e.innerHTML=a}generateRecentOrders(){const e=document.getElementById("recentOrdersBody"),t=document.getElementById("ordersCount");if(!e)return;const s=[{id:"#1847",customer:"John Doe",product:"Laptop Pro X1",amount:"$1,299",status:"Delivered",date:"2024-12-10"},{id:"#1846",customer:"Jane Smith",product:"Wireless Mouse",amount:"$29",status:"Processing",date:"2024-12-10"},{id:"#1845",customer:"Bob Johnson",product:"USB-C Cable",amount:"$15",status:"Shipped",date:"2024-12-09"},{id:"#1844",customer:"Alice Brown",product:'Monitor 27"',amount:"$399",status:"Delivered",date:"2024-12-09"},{id:"#1843",customer:"Charlie Wilson",product:"Keyboard RGB",amount:"$89",status:"Cancelled",date:"2024-12-08"}];t&&(t.textContent=s.length);const a={Delivered:"success",Processing:"warning",Shipped:"info",Cancelled:"danger"},n=s.map(e=>"\n            <tr>\n                <td><strong>".concat(e.id,"</strong></td>\n                <td>").concat(e.customer,"</td>\n                <td>").concat(e.product,"</td>\n                <td><strong>").concat(e.amount,'</strong></td>\n                <td><span class="badge bg-').concat(a[e.status],'">').concat(e.status,"</span></td>\n                <td>").concat(e.date,'</td>\n                <td>\n                    <button class="btn btn-sm btn-outline-primary" title="View">\n                        <i class="fas fa-eye"></i>\n                    </button>\n                    <button class="btn btn-sm btn-outline-secondary" title="Edit">\n                        <i class="fas fa-edit"></i>\n                    </button>\n                </td>\n            </tr>\n        ')).join("");e.innerHTML=n}generateTopProducts(){const e=document.getElementById("topProductsList");if(!e)return;const t=[{name:"Laptop Pro X1",sales:145,revenue:"$188,355",trend:"up"},{name:"Wireless Mouse",sales:432,revenue:"$12,528",trend:"up"},{name:'Monitor 27"',sales:89,revenue:"$35,511",trend:"down"},{name:"USB-C Cable",sales:567,revenue:"$8,505",trend:"up"},{name:"Keyboard RGB",sales:234,revenue:"$20,826",trend:"up"}].map((e,t)=>'\n            <div class="product-item d-flex justify-content-between align-items-center mb-3 pb-3 border-bottom">\n                <div class="d-flex align-items-center">\n                    <div class="product-rank me-3">\n                        <span class="badge '.concat(0===t?"bg-warning":"bg-secondary",'">#').concat(t+1,'</span>\n                    </div>\n                    <div>\n                        <h6 class="mb-0">').concat(e.name,'</h6>\n                        <small class="text-muted">').concat(e.sales,' sales</small>\n                    </div>\n                </div>\n                <div class="text-end">\n                    <strong class="d-block">').concat(e.revenue,'</strong>\n                    <small class="').concat("up"===e.trend?"text-success":"text-danger",'">\n                        <i class="fas fa-arrow-').concat(e.trend,'"></i>\n                    </small>\n                </div>\n            </div>\n        ')).join("");e.innerHTML=t}generatePerformanceMetrics(){const e=document.getElementById("performanceMetrics");if(!e)return;const t=[{label:"Customer Satisfaction",value:94,color:"success"},{label:"Order Fulfillment",value:87,color:"info"},{label:"Product Quality",value:92,color:"primary"},{label:"Delivery Speed",value:78,color:"warning"}].map(e=>'\n            <div class="metric-item mb-4">\n                <div class="d-flex justify-content-between align-items-center mb-2">\n                    <span>'.concat(e.label,"</span>\n                    <strong>").concat(e.value,'%</strong>\n                </div>\n                <div class="progress" style="height: 8px;">\n                    <div class="progress-bar bg-').concat(e.color,'" role="progressbar" \n                         style="width: ').concat(e.value,'%" \n                         aria-valuenow="').concat(e.value,'" \n                         aria-valuemin="0" \n                         aria-valuemax="100">\n                    </div>\n                </div>\n            </div>\n        ')).join("");e.innerHTML=t}initializeCharts(){this.initSalesChart(),this.initRevenueChart(),this.initTrafficChart()}initSalesChart(){const e=document.getElementById("salesChart");if(!e)return;const t=e.getContext("2d");this.chartInstances.sales=new Chart(t,{type:"line",data:{labels:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],datasets:[{label:"Sales",data:[12,19,15,25,22,30,28],borderColor:"rgb(220, 38, 38)",backgroundColor:"rgba(220, 38, 38, 0.1)",tension:.4,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,grid:{display:!0,color:"rgba(0,0,0,0.05)"}},x:{grid:{display:!1}}}}})}initRevenueChart(){const e=document.getElementById("revenueChart");if(!e)return;const t=e.getContext("2d");this.chartInstances.revenue=new Chart(t,{type:"doughnut",data:{labels:["Products","Services","Subscriptions","Others"],datasets:[{data:[45,25,20,10],backgroundColor:["rgb(220, 38, 38)","rgb(59, 130, 246)","rgb(16, 185, 129)","rgb(245, 158, 11)"]}]},options:{responsive:!0,maintainAspectRatio:!0,plugins:{legend:{position:"bottom"}}}})}initTrafficChart(){const e=document.getElementById("trafficChart");if(!e)return;const t=e.getContext("2d");this.chartInstances.traffic=new Chart(t,{type:"bar",data:{labels:["Direct","Organic","Social","Email","Referral"],datasets:[{label:"Visitors",data:[1200,1900,800,600,400],backgroundColor:"rgb(220, 38, 38)"}]},options:{responsive:!0,maintainAspectRatio:!0,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}}})}updateSalesChart(){if(!this.chartInstances.sales)return;const e={week:{labels:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],values:[12,19,15,25,22,30,28]},month:{labels:["Week 1","Week 2","Week 3","Week 4"],values:[85,110,95,125]},year:{labels:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],values:[450,520,490,580,610,650,700,680,720,750,800,850]}}[this.currentPeriod];this.chartInstances.sales.data.labels=e.labels,this.chartInstances.sales.data.datasets[0].data=e.values,this.chartInstances.sales.update()}refreshDashboard(){const e=document.getElementById("btnRefreshDashboard");if(e){const t=e.innerHTML;e.innerHTML='<i class="fas fa-spinner fa-spin me-2"></i>Refreshing...',e.disabled=!0,setTimeout(()=>{this.generateStatsCards(),this.generateActivityTimeline(),this.generateRecentOrders(),this.generateTopProducts(),this.generatePerformanceMetrics(),e.innerHTML=t,e.disabled=!1,this.showNotification("success","Dashboard refreshed successfully!")},1e3)}}exportReport(){const e=document.getElementById("btnExportReport");if(e){const t=e.innerHTML;e.innerHTML='<i class="fas fa-spinner fa-spin me-2"></i>Exporting...',e.disabled=!0,setTimeout(()=>{e.innerHTML=t,e.disabled=!1,this.showNotification("success","Report exported successfully!");const s=document.createElement("a");s.href="#",s.download="dashboard-report.pdf",s.click()},1500)}}showNotification(e,t){window.showNotification&&window.showNotification(e,t)}};const Y=new class{constructor(){this.currentTab="active",this.currentPage=1,this.pageSize=15,this.filteredData=[],this.loading=!1,this.totalItems=0,this.totalPages=1,this.searchTerm="",this.departmentFilter="",this.statusFilter=""}async initialize(){this.setupEventListeners(),await this.loadEmployees()}async loadEmployees(){try{this.loading=!0,this.showLoading(!0);const e={page:this.currentPage,pageSize:this.pageSize};this.searchTerm&&this.searchTerm.trim()&&(e.search=this.searchTerm.trim()),this.departmentFilter;const t=await S.employee.getEmployeesGrid(e);t.isSuccess?(t.data&&Array.isArray(t.data)?(this.filteredData=t.data,this.totalItems=t.totalCount||t.data.length,this.totalPages=t.totalPages||Math.ceil(this.totalItems/this.pageSize)):(this.filteredData=[],this.totalItems=0,this.totalPages=1),this.renderTable(),this.renderPagination(),this.updateCounts(),await this.updateTabCounts()):(this.showError("Failed to load employees: "+t.message),this.filteredData=[])}catch(e){this.showError("Network error. Please check your connection."),this.filteredData=[]}finally{this.loading=!1,this.showLoading(!1)}}async updateTabCounts(){try{const e=await S.employee.getActiveEmployees();if(e.isSuccess&&e.data){const t=e.data.length||0;document.getElementById("activeCount").textContent=t}const t=await S.employee.getEmployees();if(t.isSuccess&&t.data){const e=t.data.length||0,s=e-(parseInt(document.getElementById("activeCount").textContent)||0);document.getElementById("inactiveCount").textContent=s>0?s:0}}catch(e){}}setupEventListeners(){const e=document.getElementById("btnAddEmployee");e&&e.addEventListener("click",()=>this.redirectToAdd());const t=document.getElementById("btnRefreshEmployees");t&&t.addEventListener("click",()=>this.handleRefresh());const s=document.getElementById("searchEmployee");if(s){let e;s.addEventListener("input",t=>{clearTimeout(e),e=setTimeout(()=>{this.searchTerm=t.target.value,this.currentPage=1,this.loadEmployees()},500)})}const a=document.getElementById("filterDepartment");a&&a.addEventListener("change",e=>{this.departmentFilter=e.target.value,this.currentPage=1,this.loadEmployees()});const n=document.getElementById("filterStatus");n&&n.addEventListener("change",e=>{this.statusFilter=e.target.value,this.currentPage=1,this.applyClientSideFilters()});const i=document.getElementById("btnResetFilters");i&&i.addEventListener("click",()=>this.resetFilters());const o=document.querySelector("#active-tab"),r=document.querySelector("#inactive-tab");if(o&&o.addEventListener("click",e=>{e.preventDefault(),this.currentTab="active",this.currentPage=1,this.applyClientSideFilters()}),r&&r.addEventListener("click",e=>{e.preventDefault(),this.currentTab="inactive",this.currentPage=1,this.applyClientSideFilters()}),"undefined"!=typeof bootstrap){const e=document.querySelector("#employeeTabs");e&&(new bootstrap.Tab(e),e.addEventListener("shown.bs.tab",e=>{const t=e.target.getAttribute("data-bs-target");"#active-pane"===t?this.currentTab="active":"#inactive-pane"===t&&(this.currentTab="inactive"),this.currentPage=1,this.applyClientSideFilters()}))}}applyClientSideFilters(){this.loadEmployees()}resetFilters(){document.getElementById("searchEmployee").value="",document.getElementById("filterDepartment").value="",document.getElementById("filterStatus").value="",this.searchTerm="",this.departmentFilter="",this.statusFilter="",this.currentPage=1,this.loadEmployees()}async handleRefresh(){const e=document.getElementById("btnRefreshEmployees");e&&(e.innerHTML='<i class="fas fa-sync-alt fa-spin me-2"></i>Refreshing...',e.disabled=!0);try{await this.loadEmployees(),this.showNotification("success","âœ… Employees refreshed successfully")}catch(t){this.showNotification("danger","âŒ Failed to refresh employees")}finally{e&&(e.innerHTML='<i class="fas fa-sync-alt me-2"></i>Refresh',e.disabled=!1)}}renderTable(){const e="active"===this.currentTab?"activeTableBody":"inactiveTableBody",t="active"===this.currentTab?"activeEmpty":"inactiveEmpty";this.currentTab;const s=document.getElementById(e),a=document.getElementById(t),n=document.querySelector("#".concat("active"===this.currentTab?"active-pane":"inactive-pane"," .table-responsive"));if(!s)return;if(0===this.filteredData.length)return a&&a.classList.remove("d-none"),void(n&&n.classList.add("d-none"));a&&a.classList.add("d-none"),n&&n.classList.remove("d-none");let i=this.filteredData;i="active"===this.currentTab?i.filter(e=>!0===e.isActive):i.filter(e=>!1===e.isActive),this.departmentFilter&&""!==this.departmentFilter&&(i=i.filter(e=>e.department===this.departmentFilter)),this.statusFilter&&""!==this.statusFilter&&("active"===this.statusFilter?i=i.filter(e=>!0===e.isActive):"inactive"===this.statusFilter&&(i=i.filter(e=>!1===e.isActive))),s.innerHTML="",i.forEach((e,t)=>{if(!e||!e.fullName)return;const a=document.createElement("tr"),n=(this.currentPage-1)*this.pageSize+t+1;a.innerHTML="\n        <td>".concat(n,'</td>\n        <td>\n          <div class="d-flex align-items-center">\n            <div class="avatar avatar-sm me-2 bg-primary">\n              <span class="avatar-text">').concat(e.fullName.charAt(0).toUpperCase(),"</span>\n            </div>\n            <div>\n              <strong>").concat(e.fullName,'</strong>\n              <small class="text-muted d-block">').concat(e.employeeCode||"No Code","</small>\n            </div>\n          </div>\n        </td>\n        <td>").concat(e.email||"N/A","</td>\n        <td>").concat(e.position||"N/A",'</td>\n        <td><span class="badge bg-info">').concat(e.department||"N/A",'</span></td>\n        <td>\n          <span class="badge ').concat(e.isActive?"bg-success":"bg-secondary",'">\n            ').concat(e.isActive?"Active":"Inactive",'\n          </span>\n        </td>\n        <td class="text-center">\n          <div class="btn-group btn-group-sm">\n            <button class="btn btn-outline-primary btn-edit" \n                    data-id="').concat(e.employeeId,'" \n                    title="Edit">\n              <i class="fas fa-edit"></i>\n            </button>\n            <button class="btn btn-outline-danger btn-delete" \n                    data-id="').concat(e.employeeId,'" \n                    title="Delete">\n              <i class="fas fa-trash"></i>\n            </button>\n          </div>\n        </td>\n      '),s.appendChild(a)}),this.attachRowEventListeners()}attachRowEventListeners(){const e="active"===this.currentTab?"activeTableBody":"inactiveTableBody",t=document.getElementById(e);t&&(t.querySelectorAll(".btn-edit").forEach(e=>{e.addEventListener("click",e=>{const t=parseInt(e.currentTarget.dataset.id);this.redirectToEdit(t)})}),t.querySelectorAll(".btn-delete").forEach(e=>{e.addEventListener("click",async e=>{const t=parseInt(e.currentTarget.dataset.id);await this.handleDelete(t)})}))}renderPagination(){const e=document.getElementById("employeesPagination");if(!e)return;if(this.totalPages<=1)return void(e.innerHTML="");let t="";t+='\n      <li class="page-item '.concat(1===this.currentPage?"disabled":"",'">\n        <a class="page-link" href="#" data-page="').concat(this.currentPage-1,'">\n          <i class="fas fa-chevron-left"></i>\n        </a>\n      </li>\n    ');let s=Math.max(1,this.currentPage-Math.floor(2.5)),a=Math.min(this.totalPages,s+5-1);a-s<4&&(s=Math.max(1,a-5+1)),s>1&&(t+='\n        <li class="page-item">\n          <a class="page-link" href="#" data-page="1">1</a>\n        </li>\n        '.concat(s>2?'<li class="page-item disabled"><span class="page-link">...</span></li>':"","\n      "));for(let n=s;n<=a;n++)t+='\n        <li class="page-item '.concat(n===this.currentPage?"active":"",'">\n          <a class="page-link" href="#" data-page="').concat(n,'">').concat(n,"</a>\n        </li>\n      ");a<this.totalPages&&(t+="\n        ".concat(a<this.totalPages-1?'<li class="page-item disabled"><span class="page-link">...</span></li>':"",'\n        <li class="page-item">\n          <a class="page-link" href="#" data-page="').concat(this.totalPages,'">').concat(this.totalPages,"</a>\n        </li>\n      ")),t+='\n      <li class="page-item '.concat(this.currentPage===this.totalPages?"disabled":"",'">\n        <a class="page-link" href="#" data-page="').concat(this.currentPage+1,'">\n          <i class="fas fa-chevron-right"></i>\n        </a>\n      </li>\n    '),e.innerHTML=t,this.attachPaginationListeners()}attachPaginationListeners(){const e=document.getElementById("employeesPagination");e&&e.querySelectorAll(".page-link").forEach(e=>{e.addEventListener("click",e=>{e.preventDefault();const t=parseInt(e.currentTarget.dataset.page);!isNaN(t)&&t>=1&&t<=this.totalPages&&t!==this.currentPage&&this.goToPage(t)})})}goToPage(e){this.currentPage=e,this.loadEmployees();const t=document.querySelector(".table-responsive");t&&t.scrollIntoView({behavior:"smooth",block:"start"})}updateCounts(){const e=(this.currentPage-1)*this.pageSize+1,t=Math.min(this.currentPage*this.pageSize,this.totalItems);document.getElementById("showingEmployees").textContent=this.totalItems>0?"".concat(e,"-").concat(t):"0",document.getElementById("totalFilteredEmployees").textContent=this.totalItems}showLoading(e){const t=document.getElementById("employeesLoading");if(t)t.style.display=e?"block":"none";else{const e=document.createElement("div");e.id="employeesLoading",e.className="text-center py-5",e.innerHTML='<i class="fas fa-spinner fa-spin fa-2x text-primary"></i><p class="mt-2">Loading employees...</p>';const t=document.querySelector("#employeesPage .card-body");t&&t.prepend(e)}}redirectToAdd(){this.navigateTo("employeescreate")}redirectToEdit(e){sessionStorage.setItem("crudId",e),sessionStorage.setItem("crudMode","update"),this.navigateTo("employeesupdate")}async handleDelete(e){const t=this.filteredData.find(t=>t.employeeId===e);if(!t)return;if(confirm('Are you sure you want to delete employee "'.concat(t.fullName,'"?\n\nThis action cannot be undone.')))try{await S.employee.deleteEmployee(e),await this.loadEmployees(),this.showNotification("success","âœ… Employee deleted successfully")}catch(s){this.showNotification("danger","âŒ Failed to delete employee: "+s.message)}}showNotification(e,t){if(window.showNotification)window.showNotification(e,t);else if("undefined"!=typeof bootstrap&&bootstrap.Toast){if(!document.querySelector(".toast-container")){const e=document.createElement("div");e.className="toast-container position-fixed top-0 end-0 p-3",e.style.zIndex="1060",document.body.appendChild(e)}const s="notification-"+Date.now(),a='\n        <div id="'.concat(s,'" class="toast" role="alert" aria-live="assertive" aria-atomic="true">\n          <div class="toast-header bg-').concat(e,' text-white">\n            <strong class="me-auto">').concat("success"===e?"Success":"Error",'</strong>\n            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast"></button>\n          </div>\n          <div class="toast-body">').concat(t,"</div>\n        </div>\n      ");document.querySelector(".toast-container").insertAdjacentHTML("beforeend",a);const n=document.getElementById(s);new bootstrap.Toast(n).show(),n.addEventListener("hidden.bs.toast",()=>{n.remove()})}else alert(t)}showError(e){this.showNotification("danger",e)}navigateTo(e){window.router?window.router.navigate(e):window.location.href="/".concat(e)}};const W=new class{constructor(){this.mode="create",this.employeeId=null,this.employee=null,this.initialized=!1,this.handleSubmitBound=null,this.handleCancelBound=null}async initialize(){if(!this.initialized)try{this.mode=sessionStorage.getItem("crudMode")||"create",this.employeeId=sessionStorage.getItem("crudId"),await this.waitForDOM(),this.setupEventListeners(),this.updatePageTitle(),"update"===this.mode&&this.employeeId?await this.loadEmployee(parseInt(this.employeeId)):this.hideUpdateFields(),this.initialized=!0}catch(e){this.showError("Failed to initialize page")}}waitForDOM(){return new Promise(e=>{"complete"===document.readyState||"interactive"===document.readyState?setTimeout(e,100):document.addEventListener("DOMContentLoaded",()=>setTimeout(e,100))})}hideUpdateFields(){const e=document.getElementById("isActiveField");e&&e.classList.add("d-none")}showUpdateFields(){const e=document.getElementById("isActiveField");e&&e.classList.remove("d-none")}setupEventListeners(){const e=document.getElementById("employeeForm"),t=document.getElementById("btnSaveEmployee"),s=document.getElementById("btnCancelEmployee"),a=document.getElementById("btnBackToEmployees");e&&t&&s&&(this.handleSubmitBound&&(e.removeEventListener("submit",this.handleSubmitBound),t.removeEventListener("click",this.handleSubmitBound)),this.handleCancelBound&&(s.removeEventListener("click",this.handleCancelBound),a&&a.removeEventListener("click",this.handleCancelBound)),this.handleSubmitBound=this.handleSubmit.bind(this),this.handleCancelBound=this.handleCancel.bind(this),e.addEventListener("submit",this.handleSubmitBound),t.addEventListener("click",e=>{e.preventDefault(),this.handleSubmitBound()}),s.addEventListener("click",this.handleCancelBound),a&&a.addEventListener("click",this.handleCancelBound))}updatePageTitle(){const e=document.getElementById("crudTitle"),t=document.getElementById("breadcrumbAction");"update"===this.mode?(e&&(e.innerHTML='<i class="fas fa-user me-2"></i>Edit Employee'),t&&(t.textContent="Edit"),this.showUpdateFields()):(e&&(e.innerHTML='<i class="fas fa-user me-2"></i>Add New Employee'),t&&(t.textContent="Add New"))}async loadEmployee(e){try{const t=await S.employee.getEmployee(e);if(!t.isSuccess||!t.data)throw new Error(t.message||"Failed to load employee");this.employee=t.data,this.populateForm(this.employee)}catch(t){this.showError("Failed to load employee data")}}populateForm(e){if([{id:"fullName",value:e.fullName||""},{id:"email",value:e.email||""},{id:"phoneNumber",value:e.phoneNumber||""},{id:"department",value:e.department||""},{id:"position",value:e.position||""}].forEach(({id:e,value:t})=>{const s=document.getElementById(e);s&&(s.value=t)}),"update"===this.mode){const t=document.getElementById("isActive");t&&(t.checked=!1!==e.isActive)}}getFormData(){const e={},t=(e,t=!1)=>{const s=document.getElementById(e);if(!s)return t?null:void 0;const a=s.value.trim();return""===a&&t?null:""!==a?a:void 0};e.fullName=t("fullName");const s=t("email",!0);void 0!==s&&(e.email=s);const a=t("phoneNumber",!0);void 0!==a&&(e.phoneNumber=a);const n=t("department",!0);void 0!==n&&(e.department=n);const i=t("position",!0);if(void 0!==i&&(e.position=i),"update"===this.mode){const t=document.getElementById("isActive");t&&(e.isActive=t.checked)}return e}validateFormData(e){const t=[];return e.fullName&&""!==e.fullName.trim()?e.fullName.length>100?(t.push("Full Name must be less than 100 characters"),this.highlightField("fullName",!0)):this.highlightField("fullName",!1):(t.push("Full Name is required"),this.highlightField("fullName",!0)),e.email&&e.email.length>100?(t.push("Email must be less than 100 characters"),this.highlightField("email",!0)):e.email&&!this.isValidEmail(e.email)?(t.push("Please enter a valid email address"),this.highlightField("email",!0)):void 0!==e.email&&this.highlightField("email",!1),e.phoneNumber&&e.phoneNumber.length>20?(t.push("Phone Number must be less than 20 characters"),this.highlightField("phoneNumber",!0)):void 0!==e.phoneNumber&&this.highlightField("phoneNumber",!1),e.department&&e.department.length>50?(t.push("Department must be less than 50 characters"),this.highlightField("department",!0)):void 0!==e.department&&this.highlightField("department",!1),e.position&&e.position.length>50?(t.push("Position must be less than 50 characters"),this.highlightField("position",!0)):void 0!==e.position&&this.highlightField("position",!1),!(t.length>0)||(this.showError(t.join("<br>")),!1)}isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}highlightField(e,t){const s=document.getElementById(e);if(!s)return;const a=s.closest(".mb-3");if(a){const e=a.querySelector(".invalid-feedback");e&&t&&(e.style.display="block")}t?(s.classList.add("is-invalid"),s.classList.remove("is-valid")):(s.classList.remove("is-invalid"),s.classList.add("is-valid"))}showError(e){const t=document.getElementById("errorToast");if(t&&"undefined"!=typeof bootstrap){const s=t.querySelector(".toast-body");s&&(s.innerHTML=e);new bootstrap.Toast(t).show()}else alert(e)}showSuccess(e){const t=document.getElementById("successToast");if(t&&"undefined"!=typeof bootstrap){const s=t.querySelector(".toast-body");s&&(s.textContent=e);new bootstrap.Toast(t).show()}else alert(e)}async handleSubmit(e){e&&e.preventDefault();const t=document.getElementById("btnSaveEmployee");if(t)try{const e=this.getFormData();if(!this.validateFormData(e))return;t.innerHTML;let s;if(t.disabled=!0,t.innerHTML='<i class="fas fa-spinner fa-spin me-2"></i>Saving...',s="update"===this.mode?await S.employee.updateEmployee(this.employeeId,e):await S.employee.createEmployee(e),!s.isSuccess)throw new Error(s.message||"Failed to save employee");{const e="update"===this.mode?"Employee updated successfully!":"Employee created successfully!";this.showSuccess(e),setTimeout(()=>{this.cleanupAndNavigate()},1500)}}catch(s){this.showError(s.message||"Failed to save employee. Please try again.")}finally{t&&(t.disabled=!1,t.innerHTML='<i class="fas fa-save me-2"></i>Save Employee')}}handleCancel(){this.cleanupAndNavigate()}cleanupAndNavigate(){sessionStorage.removeItem("crudMode"),sessionStorage.removeItem("crudId"),window.router?window.router.navigate("employees"):window.location.href="/employees"}destroy(){if(this.handleSubmitBound){const e=document.getElementById("employeeForm"),t=document.getElementById("btnSaveEmployee");e&&e.removeEventListener("submit",this.handleSubmitBound),t&&t.removeEventListener("click",this.handleSubmitBound)}if(this.handleCancelBound){const e=document.getElementById("btnCancelEmployee"),t=document.getElementById("btnBackToEmployees");e&&e.removeEventListener("click",this.handleCancelBound),t&&t.removeEventListener("click",this.handleCancelBound)}this.handleSubmitBound=null,this.handleCancelBound=null,this.initialized=!1}};const G=new class{constructor(){this.assets=[],this.categories=[],this.filteredData=[],this.currentTab="available",this.currentPage=1,this.pageSize=10,this.loading=!1,this.totalItems=0,this.totalPages=1,this.searchTimeout=null}async initialize(){try{this.setupEventListeners(),await this.loadCategories(),await this.loadFromAPI(),this.populateCategories(),this.updateStats(),this.renderCurrentTab()}catch(e){this.showError("Failed to initialize assets menu")}}async loadFromAPI(){if(!this.loading)try{this.loading=!0,this.showLoading(!0);const e=await S.asset.getAssetsGrid({page:this.currentPage,pageSize:this.pageSize});if(!e.isSuccess||!e.data)throw new Error(e.message||"Failed to load assets");this.assets=e.data,this.totalItems=e.totalCount||0,this.totalPages=e.totalPages||1,this.filteredData=[...this.assets]}catch(e){this.showError("Failed to load assets")}finally{this.loading=!1,this.showLoading(!1)}}async loadCategories(){try{const e=await S.category.getActiveCategories();if(!e.isSuccess||!e.data)throw new Error(e.message||"Failed to load categories");this.categories=e.data}catch(e){this.showError("Failed to load categories")}}showLoading(e){const t=document.getElementById("assetsLoading");t&&(t.style.display=e?"block":"none")}populateCategories(){const e=document.getElementById("filterCategory");e&&(e.innerHTML='<option value="">All Categories</option>',this.categories.forEach(t=>{const s=document.createElement("option");s.value=t.categoryName||t.name||t,s.textContent=t.categoryName||t.name||t,e.appendChild(s)}))}setupEventListeners(){const e=document.getElementById("btnAddAsset");e&&e.addEventListener("click",()=>this.handleAdd());const t=document.getElementById("btnRefreshAssets");t&&t.addEventListener("click",()=>this.handleRefresh());const s=document.getElementById("searchAssets");s&&s.addEventListener("input",e=>{clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.applyFilters()},300)});const a=document.getElementById("filterCategory"),n=document.getElementById("filterStatus");a&&a.addEventListener("change",()=>this.applyFilters()),n&&n.addEventListener("change",()=>this.applyFilters());const i=document.getElementById("btnResetFilters");i&&i.addEventListener("click",()=>this.resetFilters());const o=document.getElementById("assetTabs");o&&o.addEventListener("shown.bs.tab",e=>{const t=e.target.id;"availableTab"===t?this.currentTab="available":"inuseTab"===t?this.currentTab="inuse":"maintenanceTab"===t&&(this.currentTab="maintenance"),this.currentPage=1,this.renderCurrentTab()})}async handleRefresh(){const e=document.getElementById("btnRefreshAssets");if(!e)return;const t=e.innerHTML;e.disabled=!0,e.innerHTML='<i class="fas fa-sync-alt fa-spin me-2"></i>Refreshing...';try{await this.loadFromAPI(),await this.loadCategories(),this.updateStats(),this.renderCurrentTab(),this.showNotification("Assets refreshed successfully","success")}catch(s){this.showNotification("Failed to refresh assets","danger")}finally{e.disabled=!1,e.innerHTML=t}}applyFilters(){var e,t,s;const a=(null==(e=document.getElementById("searchAssets"))?void 0:e.value.toLowerCase())||"",n=(null==(t=document.getElementById("filterCategory"))?void 0:t.value)||"",i=(null==(s=document.getElementById("filterStatus"))?void 0:s.value)||"";this.filteredData=this.assets.filter(e=>{let t=!0;if(a){const s=[e.assetName,e.assetCode,e.categoryName,e.serialNumber].map(e=>(null==e?void 0:e.toLowerCase())||"");t=t&&s.some(e=>e.includes(a))}return n&&"All Categories"!==n&&(t=t&&e.categoryName===n),i&&"All Status"!==i&&(t=t&&e.status===i),t}),this.currentPage=1,this.updateStats(),this.renderCurrentTab()}resetFilters(){const e=document.getElementById("searchAssets"),t=document.getElementById("filterCategory"),s=document.getElementById("filterStatus");e&&(e.value=""),t&&(t.value=""),s&&(s.value=""),this.applyFilters()}updateStats(){const e=this.assets.length,t=this.assets.filter(e=>"Available"===e.status).length,s=this.assets.filter(e=>"In Use"===e.status).length,a=this.assets.filter(e=>"Maintenance"===e.status).length,n=(e,t)=>{const s=document.getElementById(e);s&&(s.textContent=t)};n("totalAssets",e),n("availableAssets",t),n("inUseAssets",s),n("maintenanceAssets",a)}renderCurrentTab(){let e=[],t="",s="";switch(this.currentTab){case"available":e=this.filteredData.filter(e=>"Available"===e.status),t="availableEmpty",s="availableTableBody";break;case"inuse":e=this.filteredData.filter(e=>"In Use"===e.status),t="inuseEmpty",s="inuseTableBody";break;case"maintenance":e=this.filteredData.filter(e=>"Maintenance"===e.status),t="maintenanceEmpty",s="maintenanceTableBody"}this.updateBadgeCounts(),this.renderTable(s,t,e);const a=document.getElementById("showingCount"),n=document.getElementById("totalCount");a&&(a.textContent=e.length),n&&(n.textContent=this.assets.length),this.renderPagination()}updateBadgeCounts(){const e=this.filteredData.filter(e=>"Available"===e.status).length,t=this.filteredData.filter(e=>"In Use"===e.status).length,s=this.filteredData.filter(e=>"Maintenance"===e.status).length,a=(e,t)=>{const s=document.getElementById(e);s&&(s.textContent=t)};a("availableCount",e),a("inuseCount",t),a("maintenanceCount",s)}renderTable(e,t,s){const a=document.getElementById(e),n=document.getElementById(t),i=null==a?void 0:a.closest(".table-responsive");if(!a||!n||!i)return;if(0===s.length)return i.classList.add("d-none"),void n.classList.remove("d-none");i.classList.remove("d-none"),n.classList.add("d-none");const o=document.createDocumentFragment();s.forEach((e,t)=>{const s=this.createTableRow(e,t);o.appendChild(s)}),a.innerHTML="",a.appendChild(o),this.attachRowEventListeners(a)}createTableRow(e,t){const s=document.createElement("tr"),a=(this.currentPage-1)*this.pageSize+t+1;let n="";switch(this.currentTab){case"available":n="\n          <td>".concat(a,"</td>\n          <td><strong>").concat(this.escapeHtml(e.assetName||"N/A"),"</strong></td>\n          <td><code>").concat(this.escapeHtml(e.assetCode||"N/A"),'</code></td>\n          <td><span class="badge bg-info">').concat(this.escapeHtml(e.categoryName||"N/A"),"</span></td>\n          <td>").concat(this.formatDate(e.purchaseDate),"</td>\n          <td>").concat(this.formatCurrency(e.purchasePrice),'</td>\n          <td>\n            <button class="btn btn-sm btn-outline-primary btn-edit" data-id="').concat(e.assetId,'" title="Edit">\n              <i class="fas fa-edit"></i>\n            </button>\n            <button class="btn btn-sm btn-outline-danger btn-delete" data-id="').concat(e.assetId,'" title="Delete">\n              <i class="fas fa-trash"></i>\n            </button>\n          </td>\n        ');break;case"inuse":n="\n          <td>".concat(a,"</td>\n          <td><strong>").concat(this.escapeHtml(e.assetName||"N/A"),"</strong></td>\n          <td><code>").concat(this.escapeHtml(e.assetCode||"N/A"),'</code></td>\n          <td><span class="badge bg-info">').concat(this.escapeHtml(e.categoryName||"N/A"),"</span></td>\n          <td>").concat(this.escapeHtml(e.currentHolderName||"N/A"),"</td>\n          <td>").concat(this.formatDate(e.assignedDate),'</td>\n          <td>\n            <button class="btn btn-sm btn-outline-primary btn-edit" data-id="').concat(e.assetId,'" title="Edit">\n              <i class="fas fa-edit"></i>\n            </button>\n            <button class="btn btn-sm btn-outline-danger btn-delete" data-id="').concat(e.assetId,'" title="Delete">\n              <i class="fas fa-trash"></i>\n            </button>\n          </td>\n        ');break;case"maintenance":n="\n          <td>".concat(a,"</td>\n          <td><strong>").concat(this.escapeHtml(e.assetName||"N/A"),"</strong></td>\n          <td><code>").concat(this.escapeHtml(e.assetCode||"N/A"),'</code></td>\n          <td><span class="badge bg-info">').concat(this.escapeHtml(e.categoryName||"N/A"),"</span></td>\n          <td>").concat(this.escapeHtml(e.condition||"N/A"),"</td>\n          <td>").concat(this.formatDate(e.maintenanceDate),'</td>\n          <td>\n            <button class="btn btn-sm btn-outline-primary btn-edit" data-id="').concat(e.assetId,'" title="Edit">\n              <i class="fas fa-edit"></i>\n            </button>\n            <button class="btn btn-sm btn-outline-danger btn-delete" data-id="').concat(e.assetId,'" title="Delete">\n              <i class="fas fa-trash"></i>\n            </button>\n          </td>\n        ')}return s.innerHTML=n,s}escapeHtml(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}formatDate(e){if(!e)return"N/A";try{const t=new Date(e);return isNaN(t.getTime())?"N/A":t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(t){return"N/A"}}formatCurrency(e){return e||0===e?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(e):"N/A"}renderPagination(){const e=document.getElementById("pagination");if(!e||this.totalPages<=1)return void(e&&(e.innerHTML=""));let t="";t+='\n      <li class="page-item '.concat(1===this.currentPage?"disabled":"",'">\n        <a class="page-link" href="#" data-page="prev">\n          <i class="fas fa-chevron-left"></i>\n        </a>\n      </li>\n    ');let s=Math.max(1,this.currentPage-Math.floor(2.5)),a=Math.min(this.totalPages,s+5-1);a-s<4&&(s=Math.max(1,a-5+1));for(let n=s;n<=a;n++)t+='\n        <li class="page-item '.concat(n===this.currentPage?"active":"",'">\n          <a class="page-link" href="#" data-page="').concat(n,'">').concat(n,"</a>\n        </li>\n      ");t+='\n      <li class="page-item '.concat(this.currentPage===this.totalPages?"disabled":"",'">\n        <a class="page-link" href="#" data-page="next">\n          <i class="fas fa-chevron-right"></i>\n        </a>\n      </li>\n    '),e.innerHTML=t,this.attachPaginationListeners(e)}attachPaginationListeners(e){e.querySelectorAll(".page-link").forEach(e=>{e.addEventListener("click",async e=>{e.preventDefault();const t=e.currentTarget.dataset.page;let s=this.currentPage;s="prev"===t?this.currentPage-1:"next"===t?this.currentPage+1:parseInt(t),s>=1&&s<=this.totalPages&&s!==this.currentPage&&(this.currentPage=s,await this.loadFromAPI(),this.renderCurrentTab())})})}handleAdd(){sessionStorage.removeItem("crudId"),sessionStorage.removeItem("crudMode"),this.navigateTo("assetscreate")}handleEdit(e){sessionStorage.setItem("crudId",e.toString()),sessionStorage.setItem("crudMode","update"),this.navigateTo("assetsupdate")}async handleDelete(e){const t=this.assets.find(t=>t.assetId===e);if(!t)return;if(await O.show({type:"danger",title:"Delete Asset",message:'Are you sure you want to delete "'.concat(t.assetName,'"? This action cannot be undone.'),okText:"Delete",cancelText:"Cancel",okClass:"btn-danger"}))try{await S.asset.deleteAsset(e),await this.loadFromAPI(),this.updateStats(),this.renderCurrentTab(),this.showNotification("Asset deleted successfully","success")}catch(s){this.showNotification("Failed to delete asset","danger")}}navigateTo(e){window.router?window.router.navigate(e):window.location.href="/".concat(e)}showNotification(e,t="info"){if(window.showNotification)window.showNotification(t,e);else if("undefined"!=typeof bootstrap&&bootstrap.Toast){const s=document.querySelector(".toast-container");if(!s){const e=document.createElement("div");e.className="toast-container position-fixed bottom-0 end-0 p-3",document.body.appendChild(e)}const a="toast-".concat(Date.now()),n='\n        <div id="'.concat(a,'" class="toast" role="alert" aria-live="assertive" aria-atomic="true">\n          <div class="toast-header bg-').concat(t,' text-white">\n            <strong class="me-auto">').concat(t.charAt(0).toUpperCase()+t.slice(1),'</strong>\n            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast"></button>\n          </div>\n          <div class="toast-body">').concat(e,"</div>\n        </div>\n      ");s.insertAdjacentHTML("beforeend",n);const i=document.getElementById(a);new bootstrap.Toast(i).show(),i.addEventListener("hidden.bs.toast",()=>{i.remove()})}else alert(e)}showError(e){this.showNotification(e,"danger")}destroy(){this.searchTimeout&&clearTimeout(this.searchTimeout)}};const K=new class{constructor(){this.mode="create",this.assetId=null,this.asset=null,this.categories=[],this.initialized=!1,this.handleSubmitBound=null,this.handleCancelBound=null}async initialize(){if(!this.initialized)try{this.mode=sessionStorage.getItem("crudMode")||"create",this.assetId=sessionStorage.getItem("crudId"),await this.waitForDOM(),await this.loadCategories(),this.setupEventListeners(),this.updatePageTitle(),"update"===this.mode&&this.assetId&&await this.loadAsset(parseInt(this.assetId)),this.initialized=!0}catch(e){this.showError("Failed to initialize page")}}waitForDOM(){return new Promise(e=>{"complete"===document.readyState||"interactive"===document.readyState?setTimeout(e,100):document.addEventListener("DOMContentLoaded",()=>setTimeout(e,100))})}async loadCategories(){try{const e=await S.category.getActiveCategories();if(!e.isSuccess||!e.data)throw new Error(e.message||"Failed to load categories");this.categories=e.data,this.populateCategoryDropdown()}catch(e){this.showError("Failed to load categories")}}populateCategoryDropdown(){const e=document.getElementById("categoryId");e&&(e.innerHTML='<option value="">Select Category</option>',this.categories.forEach(t=>{const s=document.createElement("option");s.value=t.categoryId,s.textContent=t.categoryName,e.appendChild(s)}))}setupEventListeners(){const e=document.getElementById("assetForm"),t=document.getElementById("btnSaveAsset"),s=document.getElementById("btnCancelAsset"),a=document.getElementById("btnBackToAssets");e&&t&&s&&(this.handleSubmitBound&&(e.removeEventListener("submit",this.handleSubmitBound),t.removeEventListener("click",this.handleSubmitBound)),this.handleCancelBound&&(s.removeEventListener("click",this.handleCancelBound),a&&a.removeEventListener("click",this.handleCancelBound)),this.handleSubmitBound=this.handleSubmit.bind(this),this.handleCancelBound=this.handleCancel.bind(this),e.addEventListener("submit",this.handleSubmitBound),t.addEventListener("click",e=>{e.preventDefault(),this.handleSubmitBound()}),s.addEventListener("click",this.handleCancelBound),a&&a.addEventListener("click",this.handleCancelBound))}updatePageTitle(){const e=document.getElementById("crudTitle"),t=document.getElementById("breadcrumbAction");"update"===this.mode?(e&&(e.innerHTML='<i class="fas fa-box me-2"></i>Edit Asset'),t&&(t.textContent="Edit")):(e&&(e.innerHTML='<i class="fas fa-box me-2"></i>Add New Asset'),t&&(t.textContent="Add New"))}async loadAsset(e){try{const t=await S.asset.getAsset(e);if(!t.isSuccess||!t.data)throw new Error(t.message||"Failed to load asset");this.asset=t.data,this.populateForm(this.asset),this.showUpdateFields()}catch(t){this.showError("Failed to load asset data")}}showUpdateFields(){const e=document.getElementById("statusField"),t=document.getElementById("isActiveField"),s=document.getElementById("status"),a=document.getElementById("isActive");e&&s&&(e.classList.remove("d-none"),s.value||(s.value="Available")),t&&a&&t.classList.remove("d-none")}populateForm(e){[{id:"assetName",value:e.assetName||""},{id:"serialNumber",value:e.serialNumber||""},{id:"categoryId",value:e.categoryId||""},{id:"condition",value:e.condition||""},{id:"purchasePrice",value:e.purchasePrice||""},{id:"status",value:e.status||"Available"}].forEach(({id:e,value:t})=>{const s=document.getElementById(e);s&&("checkbox"===s.type?s.checked=Boolean(t):s.value=t)});const t=document.getElementById("isActive");if(t&&(t.checked=!1!==e.isActive),e.purchaseDate){const t=document.getElementById("purchaseDate");if(t)try{const s=new Date(e.purchaseDate);t.value=s.toISOString().split("T")[0]}catch(s){}}}getFormData(){var e;const t={},s=(e,t=!1,s=!1,a=!1)=>{const n=document.getElementById(e);if(!n)return a?null:void 0;if("checkbox"===n.type)return n.checked;const i=n.value.trim();if(""===i&&a)return null;if(""!==i){if(t||s){const e=s?parseFloat(i):parseInt(i);return isNaN(e)?void 0:e}return i}};t.assetName=s("assetName"),t.categoryId=s("categoryId",!0),t.serialNumber=s("serialNumber",!1,!1,!0),t.condition=s("condition",!1,!1,!0);const a=s("purchaseDate",!1,!1,!0);void 0!==a&&(t.purchaseDate=a?new Date(a).toISOString():null);const n=s("purchasePrice",!1,!0,!0);return void 0!==n&&(t.purchasePrice=n),"update"===this.mode&&(t.status=s("status")||"Available",t.isActive=!1!==s("isActive"),(null==(e=this.asset)?void 0:e.currentHolderId)&&(t.currentHolderId=this.asset.currentHolderId)),t}validateFormData(e){const t=[];return e.assetName&&""!==e.assetName.trim()?this.highlightField("assetName",!1):(t.push("Asset Name is required"),this.highlightField("assetName",!0)),!e.categoryId||e.categoryId<=0?(t.push("Category is required"),this.highlightField("categoryId",!0)):this.highlightField("categoryId",!1),"update"===this.mode&&(e.status&&""!==e.status.trim()?this.highlightField("status",!1):(t.push("Status is required"),this.highlightField("status",!0))),!(t.length>0)||(this.showError(t.join("<br>")),!1)}highlightField(e,t){const s=document.getElementById(e);if(!s)return;const a=s.closest(".mb-3");if(a){const e=a.querySelector(".invalid-feedback");e&&t&&(e.style.display="block")}t?(s.classList.add("is-invalid"),s.classList.remove("is-valid")):(s.classList.remove("is-invalid"),s.classList.add("is-valid"))}showError(e){const t=document.getElementById("errorToast");if(t&&"undefined"!=typeof bootstrap){const s=t.querySelector(".toast-body");s&&(s.innerHTML=e);new bootstrap.Toast(t).show()}else alert(e)}showSuccess(e){const t=document.getElementById("successToast");if(t&&"undefined"!=typeof bootstrap){const s=t.querySelector(".toast-body");s&&(s.textContent=e);new bootstrap.Toast(t).show()}else alert(e)}async handleSubmit(e){e&&e.preventDefault();const t=document.getElementById("btnSaveAsset");if(t)try{const e=this.getFormData();if(!this.validateFormData(e))return;t.innerHTML;let s;if(t.disabled=!0,t.innerHTML='<i class="fas fa-spinner fa-spin me-2"></i>Saving...',s="update"===this.mode?await S.asset.updateAsset(this.assetId,e):await S.asset.createAsset(e),!s.isSuccess)throw new Error(s.message||"Failed to save asset");{const e="update"===this.mode?"Asset updated successfully!":"Asset created successfully!";this.showSuccess(e),setTimeout(()=>{this.cleanupAndNavigate()},1500)}}catch(s){this.showError(s.message||"Failed to save asset. Please try again.")}finally{t&&(t.disabled=!1,t.innerHTML='<i class="fas fa-save me-2"></i>Save Asset')}}handleCancel(){this.cleanupAndNavigate()}cleanupAndNavigate(){sessionStorage.removeItem("crudMode"),sessionStorage.removeItem("crudId"),window.router?window.router.navigate("assets"):window.location.href="/assets"}destroy(){if(this.handleSubmitBound){const e=document.getElementById("assetForm"),t=document.getElementById("btnSaveAsset");e&&e.removeEventListener("submit",this.handleSubmitBound),t&&t.removeEventListener("click",this.handleSubmitBound)}if(this.handleCancelBound){const e=document.getElementById("btnCancelAsset"),t=document.getElementById("btnBackToAssets");e&&e.removeEventListener("click",this.handleCancelBound),t&&t.removeEventListener("click",this.handleCancelBound)}this.handleSubmitBound=null,this.handleCancelBound=null,this.initialized=!1}};const J=new class{constructor(){this.categories=[],this.filteredData=[],this.currentPage=1,this.pageSize=10,this.totalItems=0,this.loading=!1}async initialize(){this.setupEventListeners(),await this.loadFromAPI(),this.render(),this.renderChart()}async loadFromAPI(){try{this.loading=!0;const e=await S.category.getCategories();e.isSuccess&&e.data?(this.categories=e.data,this.totalItems=this.categories.length,this.filteredData=[...this.categories]):(this.categories=[],this.filteredData=[])}catch(e){this.categories=[],this.filteredData=[]}finally{this.loading=!1}}setupEventListeners(){const e=document.getElementById("btnAddCategory");e&&e.addEventListener("click",()=>this.handleAdd());const t=document.getElementById("btnRefreshCategories");t&&t.addEventListener("click",async()=>{t.innerHTML='<i class="fas fa-sync-alt fa-spin me-2"></i>Refreshing...',t.disabled=!0;try{await this.loadFromAPI(),this.render(),this.renderChart(),this.showNotification("success","âœ… Categories refreshed successfully")}catch(e){this.showNotification("danger","âŒ Failed to refresh categories")}finally{t.innerHTML='<i class="fas fa-sync-alt me-2"></i>Refresh',t.disabled=!1}});const s=document.getElementById("searchCategory");if(s){let e;s.addEventListener("input",t=>{clearTimeout(e),e=setTimeout(()=>{this.applyFilters()},300)})}const a=document.getElementById("filterCategoryStatus");a&&a.addEventListener("change",()=>this.applyFilters())}applyFilters(){var e,t;const s=(null==(e=document.getElementById("searchCategory"))?void 0:e.value.toLowerCase())||"",a=(null==(t=document.getElementById("filterCategoryStatus"))?void 0:t.value)||"";this.filteredData=this.categories.filter(e=>{var t,n;let i=!0;return s&&(i=i&&((null==(t=e.categoryName)?void 0:t.toLowerCase().includes(s))||(null==(n=e.description)?void 0:n.toLowerCase().includes(s)))),"active"===a?i=i&&!0===e.isActive:"inactive"===a&&(i=i&&!1===e.isActive),i}),this.currentPage=1,this.render()}render(){const e=document.getElementById("categoriesTableBody"),t=document.getElementById("categoriesEmpty");if(!e)return;const s=(this.currentPage-1)*this.pageSize,a=s+this.pageSize,n=this.filteredData.slice(s,a);if(0===n.length)return e.innerHTML="",t&&t.classList.remove("d-none"),void this.renderPagination();t&&t.classList.add("d-none");const i=document.createDocumentFragment();n.forEach((e,t)=>{const a=document.createElement("tr");a.innerHTML="\n        <td>".concat(s+t+1,"</td>\n        <td><strong>").concat(e.categoryName||"N/A","</strong></td>\n        <td>").concat(e.description||"No description",'</td>\n        <td>\n          <span class="badge ').concat(e.isActive?"bg-success":"bg-secondary",'">\n            ').concat(e.isActive?"Active":"Inactive",'\n          </span>\n        </td>\n        <td>\n          <div class="btn-group btn-group-sm">\n            <button class="btn btn-outline-primary btn-edit" \n                    data-id="').concat(e.categoryId,'" \n                    title="Edit">\n              <i class="fas fa-edit"></i>\n            </button>\n            <button class="btn btn-outline-danger btn-delete" \n                    data-id="').concat(e.categoryId,'" \n                    title="Delete">\n              <i class="fas fa-trash"></i>\n            </button>\n          </div>\n        </td>\n      '),i.appendChild(a)}),e.innerHTML="",e.appendChild(i),this.attachRowEventListeners(e),document.getElementById("totalCategories").textContent=this.categories.length,this.renderPagination(),this.updateShowingCount()}renderPagination(){const e=document.getElementById("categoriesPagination");if(!e)return;const t=Math.ceil(this.filteredData.length/this.pageSize);if(t<=1)return void(e.innerHTML="");let s="";s+='\n      <li class="page-item '.concat(1===this.currentPage?"disabled":"",'">\n        <a class="page-link" href="#" data-page="').concat(this.currentPage-1,'">\n          <i class="fas fa-chevron-left"></i>\n        </a>\n      </li>\n    ');let a=Math.max(1,this.currentPage-Math.floor(2.5)),n=Math.min(t,a+5-1);n-a<4&&(a=Math.max(1,n-5+1));for(let i=a;i<=n;i++)s+='\n        <li class="page-item '.concat(i===this.currentPage?"active":"",'">\n          <a class="page-link" href="#" data-page="').concat(i,'">').concat(i,"</a>\n        </li>\n      ");s+='\n      <li class="page-item '.concat(this.currentPage===t?"disabled":"",'">\n        <a class="page-link" href="#" data-page="').concat(this.currentPage+1,'">\n          <i class="fas fa-chevron-right"></i>\n        </a>\n      </li>\n    '),e.innerHTML=s,this.attachPaginationListeners(e)}updateShowingCount(){const e=(this.currentPage-1)*this.pageSize+1,t=Math.min(this.currentPage*this.pageSize,this.filteredData.length),s=document.getElementById("showingCategories"),a=document.getElementById("totalFilteredCategories");s&&(s.textContent="".concat(e,"-").concat(t)),a&&(a.textContent=this.filteredData.length)}attachPaginationListeners(e){e.querySelectorAll(".page-link").forEach(e=>{e.addEventListener("click",e=>{e.preventDefault();const t=parseInt(e.currentTarget.dataset.page);isNaN(t)||this.goToPage(t)})})}goToPage(e){const t=Math.ceil(this.filteredData.length/this.pageSize);e<1||e>t||(this.currentPage=e,this.render())}attachRowEventListeners(e){e.querySelectorAll(".btn-edit").forEach(e=>{e.addEventListener("click",e=>{const t=parseInt(e.currentTarget.dataset.id);this.handleEdit(t)})}),e.querySelectorAll(".btn-delete").forEach(e=>{e.addEventListener("click",async e=>{const t=parseInt(e.currentTarget.dataset.id);await this.handleDelete(t)})})}renderChart(){const e=document.getElementById("categoryChart");if(!e||"undefined"==typeof Chart)return;window.categoryChartInstance&&window.categoryChartInstance.destroy();const t=e.getContext("2d"),s=this.categories.slice(0,5),a=s.map(e=>e.categoryName||"Unknown"),n=s.map(e=>e.items||5);window.categoryChartInstance=new Chart(t,{type:"doughnut",data:{labels:a,datasets:[{data:n,backgroundColor:["#dc2626","#3b82f6","#10b981","#f59e0b","#8b5cf6","#ec4899","#14b8a6"].slice(0,a.length),borderWidth:1,borderColor:"#fff"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{padding:20,usePointStyle:!0}},tooltip:{callbacks:{label:function(e){let t=e.label||"";return t&&(t+=": "),t+=e.parsed+" items",t}}}}}})}async handleAdd(){this.navigateTo("categoriescreate")}async handleEdit(e){this.categories.find(t=>t.categoryId===e)&&(sessionStorage.setItem("crudId",e),sessionStorage.setItem("crudMode","update"),this.navigateTo("categoriesupdate"))}async handleDelete(e){const t=this.categories.find(t=>t.categoryId===e);if(!t)return;if(await O.show({type:"danger",title:"Delete Category",message:'Delete "'.concat(t.categoryName,'"? This cannot be undone.'),okText:"Delete",cancelText:"Cancel",okClass:"btn-danger"}))try{await S.category.deleteCategory(e),await this.loadFromAPI(),this.render(),this.renderChart(),this.showNotification("success","Category deleted successfully")}catch(s){this.showNotification("danger","Failed to delete category")}}navigateTo(e){window.router?window.router.navigate(e):window.location.href="/".concat(e)}showNotification(e,t){window.showNotification?window.showNotification(e,t):alert(t)}},$=J;"undefined"!=typeof window&&(window.categoriesMenuInstance=J);const X=new class{constructor(){this.mode="create",this.categoryId=null,this.category=null,this.initialized=!1}async initialize(){if(!this.initialized)try{this.mode=sessionStorage.getItem("crudMode")||"create",this.categoryId=sessionStorage.getItem("crudId"),await this.waitForDOM(),this.setupEventListeners(),this.updatePageTitle(),"update"===this.mode&&this.categoryId&&await this.loadCategory(parseInt(this.categoryId)),this.initialized=!0}catch(e){this.showError("Failed to initialize page")}}waitForDOM(){return new Promise(e=>{"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):setTimeout(e,100)})}setupEventListeners(){let e=0;const t=()=>{e++;const s=document.getElementById("categoryForm"),a=document.getElementById("btnSaveCategory"),n=document.getElementById("btnCancelCategory"),i=document.getElementById("btnBackToCategories");if(!s||!a||!n)return e<10?void setTimeout(t,100):void this.showError("Form elements not found. Please refresh the page.");s.removeEventListener("submit",this.handleSubmitBound),this.handleSubmitBound=this.handleSubmit.bind(this),s.addEventListener("submit",this.handleSubmitBound),n.removeEventListener("click",this.handleCancelBound),this.handleCancelBound=this.handleCancel.bind(this),n.addEventListener("click",this.handleCancelBound),i&&(i.removeEventListener("click",this.handleCancelBound),i.addEventListener("click",this.handleCancelBound)),a.removeEventListener("click",this.handleSubmitBound),a.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),this.handleSubmit()})};t()}updatePageTitle(){const e=document.getElementById("crudTitle"),t=document.getElementById("breadcrumbAction");"update"===this.mode?(e&&(e.innerHTML='<i class="fas fa-tag me-2"></i>Edit Category'),t&&(t.textContent="Edit")):(e&&(e.innerHTML='<i class="fas fa-tag me-2"></i>Add New Category'),t&&(t.textContent="Add New"))}async loadCategory(e){try{const t=await S.category.getCategory(e);if(!t.isSuccess||!t.data)throw new Error(t.message||"Failed to load category");this.category=t.data,this.populateForm(this.category)}catch(t){this.showError("Failed to load category data")}}populateForm(e){const t={categoryName:e.categoryName||"",description:e.description||""};Object.entries(t).forEach(([e,t])=>{const s=document.getElementById(e);s&&(s.value=t)});const s=document.getElementById("isActive");s&&(s.checked=e.isActive||!1)}getFormData(){const e=(e,t=null)=>{const s=document.getElementById(e);return s?s.value.trim():t},t={categoryName:e("categoryName",""),description:e("description",null)};return"update"===this.mode&&(t.isActive=(e=>{const t=document.getElementById(e);return!t||t.checked})("isActive")),t}validateFormData(e){const t=[];return e.categoryName&&""!==e.categoryName.trim()?this.highlightField("categoryName",!1):(t.push("Category Name is required"),this.highlightField("categoryName",!0)),e.categoryName&&e.categoryName.length>100&&(t.push("Category Name must be less than 100 characters"),this.highlightField("categoryName",!0)),e.description&&e.description.length>500?(t.push("Description must be less than 500 characters"),this.highlightField("description",!0)):e.description&&this.highlightField("description",!1),!(t.length>0)||(this.showError(t.join("<br>")),!1)}highlightField(e,t){const s=document.getElementById(e);s&&(t?(s.classList.add("is-invalid"),s.classList.remove("is-valid")):(s.classList.remove("is-invalid"),s.classList.add("is-valid")))}showError(e){if("undefined"!=typeof bootstrap&&bootstrap.Toast){const t=document.getElementById("errorToast");if(t){const s=t.querySelector(".toast-body");s&&(s.innerHTML=e);return void new bootstrap.Toast(t).show()}}alert(e)}showSuccess(e){if("undefined"!=typeof bootstrap&&bootstrap.Toast){const t=document.getElementById("successToast");if(t){const s=t.querySelector(".toast-body");s&&(s.textContent=e);return void new bootstrap.Toast(t).show()}}alert(e)}async handleSubmit(e){e&&(e.preventDefault(),e.stopPropagation());const t=document.getElementById("btnSaveCategory");if(t)try{const e=this.getFormData();if(!this.validateFormData(e))return;t.innerHTML;let s;if(t.disabled=!0,t.innerHTML='<i class="fas fa-spinner fa-spin me-2"></i>Saving...',s="update"===this.mode?await S.category.updateCategory(this.categoryId,e):await S.category.createCategory(e),!s.isSuccess)throw new Error(s.message||"Failed to save category");this.showSuccess("update"===this.mode?"Category updated successfully!":"Category created successfully!"),setTimeout(()=>{window.router?window.router.navigate("categories"):window.location.href="/categories"},1500)}catch(s){this.showError(s.message||"Failed to save category. Please try again.")}finally{t&&(t.disabled=!1,t.innerHTML='<i class="fas fa-save me-2"></i>Save Category')}else this.showError("Save button not found. Please refresh the page.")}handleCancel(e){e&&(e.preventDefault(),e.stopPropagation()),sessionStorage.removeItem("crudMode"),sessionStorage.removeItem("crudId"),window.router?window.router.navigate("categories"):window.location.href="/categories"}destroy(){const e=document.getElementById("categoryForm"),t=document.getElementById("btnSaveCategory"),s=document.getElementById("btnCancelCategory"),a=document.getElementById("btnBackToCategories");if(this.handleSubmitBound&&e&&e.removeEventListener("submit",this.handleSubmitBound),this.handleCancelBound&&s&&s.removeEventListener("click",this.handleCancelBound),this.handleCancelBound&&a&&a.removeEventListener("click",this.handleCancelBound),t){const e=t.cloneNode(!0);t.parentNode.replaceChild(e,t)}this.initialized=!1}};const Z=new class{constructor(){this.transactions=[],this.filteredData=[],this.currentPage=1,this.pageSize=10,this.totalItems=0,this.totalPages=1,this.loading=!1,this.searchTimeout=null,this.initialized=!1}async initialize(){if(!this.initialized)try{this.setupEventListeners(),await this.loadFromAPI(),this.updateStats(),this.render(),this.initialized=!0}catch(e){this.showErrorMessage("Failed to initialize transactions menu. Please refresh the page.")}}async loadFromAPI(){if(!this.loading)try{this.loading=!0;const e=await S.transactions.getTransactions();e&&e.isSuccess&&e.data?(this.transactions=this.processTransactionData(e.data),this.totalItems=this.transactions.length,this.totalPages=Math.ceil(this.totalItems/this.pageSize),this.filteredData=[...this.transactions]):(this.transactions=[],this.filteredData=[])}catch(e){this.transactions=[],this.filteredData=[],this.showNotification("Failed to load transactions. Please try again.","danger")}finally{this.loading=!1}}processTransactionData(e){return e.map(e=>({transactionId:e.transactionId||0,assetId:e.assetId||0,assetCode:e.assetCode||"No Code",assetName:e.assetName||"Unknown Asset",fromEmployeeName:e.fromEmployeeName||"Unknown",toEmployeeName:e.toEmployeeName||"Unknown",transactionDate:e.transactionDate||(new Date).toISOString(),status:e.status||"UNKNOWN",notes:e.notes||""}))}setupEventListeners(){const e=document.getElementById("btnNewTransaction");e&&e.addEventListener("click",()=>this.handleNew());const t=document.getElementById("btnRefreshTransactions");t&&t.addEventListener("click",()=>this.handleRefresh());const s=document.getElementById("searchTransactions");s&&s.addEventListener("input",e=>{clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.applyFilters()},300)});const a=document.getElementById("filterTransactionStatus");a&&a.addEventListener("change",()=>this.applyFilters());const n=document.getElementById("filterDateFrom"),i=document.getElementById("filterDateTo");n&&n.addEventListener("change",()=>this.applyFilters()),i&&i.addEventListener("change",()=>this.applyFilters());const o=document.getElementById("btnResetFilters");o&&o.addEventListener("click",()=>this.resetFilters())}async handleRefresh(){const e=document.getElementById("btnRefreshTransactions");if(!e)return;const t=e.innerHTML;e.disabled=!0,e.innerHTML='<i class="fas fa-sync-alt fa-spin me-2"></i>Refreshing...';try{await this.loadFromAPI(),this.updateStats(),this.render(),this.showNotification("Transactions refreshed successfully","success")}catch(s){this.showNotification("Failed to refresh transactions","danger")}finally{e.disabled=!1,e.innerHTML=t}}applyFilters(){var e,t,s,a;const n=(null==(e=document.getElementById("searchTransactions"))?void 0:e.value.toLowerCase())||"",i=(null==(t=document.getElementById("filterTransactionStatus"))?void 0:t.value)||"",o=null==(s=document.getElementById("filterDateFrom"))?void 0:s.value,r=null==(a=document.getElementById("filterDateTo"))?void 0:a.value;this.filteredData=this.transactions.filter(e=>{let t=!0;if(n){const s=[e.assetName||"",e.assetCode||"",e.fromEmployeeName||"",e.toEmployeeName||"",e.status||"",e.notes||""].join(" ").toLowerCase();t=t&&s.includes(n)}if(i&&(t="UNKNOWN"===i?t&&(!e.status||"UNKNOWN"===e.status):t&&e.status===i),o&&e.transactionDate){const s=new Date(e.transactionDate).toISOString().split("T")[0];t=t&&s>=o}if(r&&e.transactionDate){const s=new Date(e.transactionDate).toISOString().split("T")[0];t=t&&s<=r}return t}),this.currentPage=1,this.totalPages=Math.ceil(this.filteredData.length/this.pageSize),this.render()}resetFilters(){const e=document.getElementById("searchTransactions"),t=document.getElementById("filterTransactionStatus"),s=document.getElementById("filterDateFrom"),a=document.getElementById("filterDateTo");e&&(e.value=""),t&&(t.value=""),s&&(s.value=""),a&&(a.value=""),this.applyFilters()}updateStats(){const e=(new Date).toISOString().split("T")[0],t=this.transactions.filter(t=>t.transactionDate&&t.transactionDate.startsWith(e)).length,s=this.transactions.filter(e=>"TRANSFER"===e.status).length,a=this.transactions.filter(e=>"ASSIGN"===e.status).length,n=this.transactions.filter(e=>"RETURN"===e.status).length,i=(e,t)=>{const s=document.getElementById(e);s&&(s.textContent=t)};i("todayTransactions",t),i("transferCount",s),i("assignCount",a),i("returnCount",n),i("totalTransactions",this.transactions.length)}render(){const e=document.getElementById("transactionsTableBody"),t=document.getElementById("transactionsEmpty"),s=null==e?void 0:e.closest(".table-responsive");if(!e||!t||!s)return;const a=(this.currentPage-1)*this.pageSize,n=a+this.pageSize,i=this.filteredData.slice(a,n);if(0===i.length)return s.classList.add("d-none"),t.classList.remove("d-none"),this.renderPagination(),void this.updateShowingCount();s.classList.remove("d-none"),t.classList.add("d-none");const o={TRANSFER:"info",ASSIGN:"primary",RETURN:"success",REPAIR:"warning",PENDING:"secondary",COMPLETED:"success",CANCELLED:"danger",UNKNOWN:"secondary"},r=document.createDocumentFragment();i.forEach((e,t)=>{const s=document.createElement("tr");s.innerHTML="\n        <td>".concat(a+t+1,"</td>\n        <td>").concat(this.formatDate(e.transactionDate),'</td>\n        <td>\n          <span class="badge bg-').concat(o[e.status]||"secondary",'">\n            ').concat(e.status||"N/A","\n          </span>\n        </td>\n        <td>\n          <strong>").concat(e.assetName||"N/A",'</strong>\n          <small class="text-muted d-block">').concat(e.assetCode||"No Code","</small>\n        </td>\n        <td>").concat(e.fromEmployeeName||"N/A","</td>\n        <td>").concat(e.toEmployeeName||"N/A",'</td>\n        <td>\n          <div class="btn-group btn-group-sm">\n            <button class="btn btn-outline-primary btn-view" \n                    data-id="').concat(e.assetTransactionsId||e.id,'" \n                    title="View Details">\n              <i class="fas fa-eye"></i>\n            </button>\n            <button class="btn btn-outline-danger btn-delete" \n                    data-id="').concat(e.assetTransactionsId||e.id,'" \n                    title="Delete">\n              <i class="fas fa-trash"></i>\n            </button>\n          </div>\n        </td>\n      '),r.appendChild(s)}),e.innerHTML="",e.appendChild(r),this.attachRowEventListeners(e),this.renderPagination(),this.updateShowingCount()}createTableRow(e,t,s){const a=document.createElement("tr"),n=e.status||"UNKNOWN",i=s[n]||"secondary";return a.innerHTML="\n      <td>".concat(t+1,'</td>\n      <td>\n        <div class="fw-semibold">').concat(this.formatDate(e.transactionDate),'</div>\n        <small class="text-muted">').concat(this.formatTime(e.transactionDate),'</small>\n      </td>\n      <td>\n        <span class="badge bg-').concat(i,'">\n          ').concat(n,'\n        </span>\n      </td>\n      <td>\n        <div class="fw-semibold">').concat(this.escapeHtml(e.assetName),'</div>\n        <small class="text-muted">').concat(this.escapeHtml(e.assetCode),"</small>\n      </td>\n      <td>").concat(this.escapeHtml(e.fromEmployeeName),"</td>\n      <td>").concat(this.escapeHtml(e.toEmployeeName),'</td>\n      <td>\n        <div class="btn-group btn-group-sm">\n          <button class="btn btn-outline-primary btn-view" \n                  data-id="').concat(e.transactionId,'" \n                  title="View Details">\n            <i class="fas fa-eye"></i>\n          </button>\n          <button class="btn btn-outline-warning btn-edit" \n                  data-id="').concat(e.transactionId,'" \n                  title="Edit">\n            <i class="fas fa-edit"></i>\n          </button>\n          <button class="btn btn-outline-danger btn-delete" \n                  data-id="').concat(e.transactionId,'" \n                  title="Delete">\n            <i class="fas fa-trash"></i>\n          </button>\n        </div>\n      </td>\n    '),a}escapeHtml(e){if(null==e)return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML}formatDate(e){if(!e)return"N/A";try{const t=new Date(e);return isNaN(t.getTime())?"N/A":t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(t){return"N/A"}}formatTime(e){if(!e)return"";try{const t=new Date(e);return isNaN(t.getTime())?"":t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}catch(t){return""}}attachRowEventListeners(e){e.querySelectorAll(".btn-view").forEach(e=>{e.addEventListener("click",e=>{const t=parseInt(e.currentTarget.dataset.id);this.handleView(t)})}),e.querySelectorAll(".btn-edit").forEach(e=>{e.addEventListener("click",e=>{const t=parseInt(e.currentTarget.dataset.id);this.handleEdit(t)})}),e.querySelectorAll(".btn-delete").forEach(e=>{e.addEventListener("click",async e=>{const t=parseInt(e.currentTarget.dataset.id);await this.handleDelete(t)})})}renderPagination(){const e=document.getElementById("transactionsPagination");if(!e||this.totalPages<=1)return void(e&&(e.innerHTML=""));let t="";t+='\n      <li class="page-item '.concat(1===this.currentPage?"disabled":"",'">\n        <a class="page-link" href="#" data-page="prev">\n          <i class="fas fa-chevron-left"></i>\n        </a>\n      </li>\n    ');let s=Math.max(1,this.currentPage-Math.floor(2.5)),a=Math.min(this.totalPages,s+5-1);a-s<4&&(s=Math.max(1,a-5+1));for(let n=s;n<=a;n++)t+='\n        <li class="page-item '.concat(n===this.currentPage?"active":"",'">\n          <a class="page-link" href="#" data-page="').concat(n,'">').concat(n,"</a>\n        </li>\n      ");t+='\n      <li class="page-item '.concat(this.currentPage===this.totalPages?"disabled":"",'">\n        <a class="page-link" href="#" data-page="next">\n          <i class="fas fa-chevron-right"></i>\n        </a>\n      </li>\n    '),e.innerHTML=t,this.attachPaginationListeners(e)}attachPaginationListeners(e){e.querySelectorAll(".page-link").forEach(e=>{e.addEventListener("click",e=>{e.preventDefault();const t=e.currentTarget.dataset.page;let s=this.currentPage;s="prev"===t?this.currentPage-1:"next"===t?this.currentPage+1:parseInt(t),s>=1&&s<=this.totalPages&&s!==this.currentPage&&(this.currentPage=s,this.render())})})}updateShowingCount(){const e=(this.currentPage-1)*this.pageSize+1,t=Math.min(this.currentPage*this.pageSize,this.filteredData.length),s=document.getElementById("showingTransactions"),a=document.getElementById("totalFilteredTransactions");s&&(s.textContent=this.filteredData.length>0?"".concat(e,"-").concat(t):"0"),a&&(a.textContent=this.filteredData.length)}handleView(e){const t=this.transactions.find(t=>(t.assetTransactionsId||t.id)===e);t&&alert("Transaction Details:\n\n"+"ID: ".concat(t.assetTransactionsId,"\n")+"Asset: ".concat(t.assetName," (").concat(t.assetCode,")\n")+"Status: ".concat(t.status,"\n")+"From: ".concat(t.fromEmployeeName,"\n")+"To: ".concat(t.toEmployeeName,"\n")+"Date: ".concat(this.formatDate(t.transactionDate)," ").concat(this.formatTime(t.transactionDate),"\n")+"Notes: ".concat(t.notes||"None"))}handleEdit(e){sessionStorage.setItem("crudId",e.toString()),sessionStorage.setItem("crudMode","update"),this.navigateTo("transactionsupdate")}async handleDelete(e){const t=this.transactions.find(t=>(t.assetTransactionsId||t.id)===e);if(!t)return;if(await O.show({type:"danger",title:"Delete Transaction",message:"Are you sure you want to delete this transaction?\n\nAsset: ".concat(t.assetName,"\nDate: ").concat(this.formatDate(t.transactionDate)),okText:"Delete",cancelText:"Cancel",okClass:"btn-danger"}))try{await S.transactions.deleteTransaction(e),await this.loadFromAPI(),this.updateStats(),this.render(),this.showNotification("Transaction deleted successfully","success")}catch(s){this.showNotification("Failed to delete transaction","danger")}}handleNew(){sessionStorage.removeItem("crudId"),sessionStorage.removeItem("crudMode"),this.navigateTo("transactionscreate")}navigateTo(e){window.router?window.router.navigate(e):window.location.href="/".concat(e)}showNotification(e,t="info"){"function"!=typeof window.showNotification?"danger"!==t&&"error"!==t||setTimeout(()=>{alert("".concat(t.toUpperCase(),": ").concat(e))},100):window.showNotification(t,e)}showError(e){this.showNotification(e,"danger")}showErrorMessage(e){if(document.querySelector(".transactions-error"))return;const t=document.createElement("div");t.className="alert alert-danger alert-dismissible fade show transactions-error",t.innerHTML='\n      <i class="fas fa-exclamation-triangle me-2"></i>\n      '.concat(e,'\n      <button type="button" class="btn-close" data-bs-dismiss="alert"></button>\n    ');const s=document.getElementById("transactionsPage");s&&s.insertBefore(t,s.firstChild)}destroy(){this.searchTimeout&&clearTimeout(this.searchTimeout),this.initialized=!1}};const Q=new class{constructor(){this.mode="create",this.assetTransactionsId=null,this.transaction=null,this.assets=[],this.employees=[],this.initialized=!1,this.handleSubmitBound=null,this.handleCancelBound=null}async initialize(){if(!this.initialized)try{this.mode=sessionStorage.getItem("crudMode")||"create",this.assetTransactionsId=sessionStorage.getItem("crudId"),await this.waitForDOM(),await Promise.all([this.loadAssets(),this.loadEmployees()]),this.setupEventListeners(),this.updatePageTitle(),"update"===this.mode&&this.assetTransactionsId&&await this.loadTransaction(parseInt(this.assetTransactionsId)),this.initialized=!0}catch(e){this.showError("Failed to initialize page")}}waitForDOM(){return new Promise(e=>{"complete"===document.readyState||"interactive"===document.readyState?setTimeout(e,100):document.addEventListener("DOMContentLoaded",()=>setTimeout(e,100))})}setDefaultTransactionDate(){const e=document.getElementById("transactionDate");if(e){const t=new Date,s=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0"),i=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");e.value="".concat(s,"-").concat(a,"-").concat(n,"T").concat(i,":").concat(o)}}async loadAssets(){try{const e=await S.asset.getAssets();e.isSuccess&&e.data?(this.assets=e.data,this.populateAssetDropdown()):this.assets=[]}catch(e){this.showError("Failed to load assets")}}async loadEmployees(){try{const e=await S.employee.getActiveEmployees();e.isSuccess&&e.data?(this.employees=e.data,this.populateEmployeeDropdowns()):this.employees=[]}catch(e){this.showError("Failed to load employees")}}populateAssetDropdown(){const e=document.getElementById("assetId");e&&(e.innerHTML='<option value="">Select Asset</option>',this.assets.forEach(t=>{const s=document.createElement("option");s.value=t.assetId;const a=t.assetCode?"".concat(t.assetCode," - ").concat(t.assetName):t.assetName||"Asset #".concat(t.assetId);s.textContent=a,e.appendChild(s)}))}populateEmployeeDropdowns(){const e=document.getElementById("fromEmployeeId"),t=document.getElementById("toEmployeeId");e&&(e.innerHTML='<option value="">Select Employee</option>'),t&&(t.innerHTML='<option value="">Select Employee</option>'),this.employees.forEach(s=>{const a=s.fullName||"Employee #".concat(s.employeeId);if(e){const t=document.createElement("option");t.value=s.employeeId,t.textContent=a,e.appendChild(t)}if(t){const e=document.createElement("option");e.value=s.employeeId,e.textContent=a,t.appendChild(e)}})}setupEventListeners(){const e=document.getElementById("transactionForm"),t=document.getElementById("btnSaveTransaction"),s=document.getElementById("btnCancelTransaction"),a=document.getElementById("btnBackToTransactions");e&&t&&s&&(this.handleSubmitBound&&(e.removeEventListener("submit",this.handleSubmitBound),t.removeEventListener("click",this.handleSubmitBound)),this.handleCancelBound&&(s.removeEventListener("click",this.handleCancelBound),a&&a.removeEventListener("click",this.handleCancelBound)),this.handleSubmitBound=this.handleSubmit.bind(this),this.handleCancelBound=this.handleCancel.bind(this),e.addEventListener("submit",this.handleSubmitBound),t.addEventListener("click",e=>{e.preventDefault(),this.handleSubmitBound()}),s.addEventListener("click",this.handleCancelBound),a&&a.addEventListener("click",this.handleCancelBound))}updatePageTitle(){const e=document.getElementById("crudTitle"),t=document.getElementById("breadcrumbAction");"update"===this.mode?(e&&(e.innerHTML='<i class="fas fa-exchange-alt me-2"></i>Edit Transaction'),t&&(t.textContent="Edit")):(e&&(e.innerHTML='<i class="fas fa-exchange-alt me-2"></i>Add New Transaction'),t&&(t.textContent="Add New"))}async loadTransaction(e){try{const t=await S.transactions.getTransaction(e);if(!t.isSuccess||!t.data)throw new Error(t.message||"Failed to load transaction");this.transaction=t.data,this.populateForm(this.transaction)}catch(t){this.showError("Failed to load transaction data")}}populateForm(e){if([{id:"assetId",value:e.assetId||""},{id:"fromEmployeeId",value:e.fromEmployeeId||""},{id:"toEmployeeId",value:e.toEmployeeId||""},{id:"status",value:e.status||""},{id:"notes",value:e.notes||""}].forEach(({id:e,value:t})=>{const s=document.getElementById(e);s&&(s.value=t)}),e.transactionDate){const s=document.getElementById("transactionDate");if(s)try{const t=new Date(e.transactionDate),a=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),o=String(t.getHours()).padStart(2,"0"),r=String(t.getMinutes()).padStart(2,"0");s.value="".concat(a,"-").concat(n,"-").concat(i,"T").concat(o,":").concat(r)}catch(t){}}}getFormData(){const e={},t=(e,t=!1,s=!1)=>{const a=document.getElementById(e);if(!a)return s?null:void 0;const n=a.value.trim();if(""===n&&s)return null;if(""!==n){if(t){const e=parseInt(n,10);return isNaN(e)?void 0:e}return n}};e.assetId=t("assetId",!0),e.status=t("status");const s=t("transactionDate");s?e.transactionDate=new Date(s).toISOString():"update"===this.mode&&this.transaction?e.transactionDate=this.transaction.transactionDate:e.transactionDate=(new Date).toISOString();const a=t("fromEmployeeId",!0,!0);void 0!==a&&(e.fromEmployeeId=a);const n=t("toEmployeeId",!0,!0);void 0!==n&&(e.toEmployeeId=n);const i=t("notes",!1,!0);return void 0!==i&&(e.notes=i),e}validateFormData(e){const t=[];if(!e.assetId||e.assetId<=0?(t.push("Asset is required"),this.highlightField("assetId",!0)):this.highlightField("assetId",!1),e.status&&""!==e.status.trim()?this.highlightField("status",!1):(t.push("Status is required"),this.highlightField("status",!0)),!e.transactionDate){t.push("Transaction date is required");const e=document.getElementById("transactionDate");e&&e.classList.add("is-invalid")}return e.notes&&e.notes.length>500?(t.push("Notes must be less than 500 characters"),this.highlightField("notes",!0)):void 0!==e.notes&&this.highlightField("notes",!1),!(t.length>0)||(this.showError(t.join("<br>")),!1)}highlightField(e,t){const s=document.getElementById(e);if(!s)return;const a=s.closest(".mb-3");if(a){const e=a.querySelector(".invalid-feedback");e&&t&&(e.style.display="block")}t?(s.classList.add("is-invalid"),s.classList.remove("is-valid")):(s.classList.remove("is-invalid"),s.classList.add("is-valid"))}showError(e){const t=document.getElementById("errorToast");if(t&&"undefined"!=typeof bootstrap){const s=t.querySelector(".toast-body");s&&(s.innerHTML=e);new bootstrap.Toast(t).show()}else alert(e)}showSuccess(e){const t=document.getElementById("successToast");if(t&&"undefined"!=typeof bootstrap){const s=t.querySelector(".toast-body");s&&(s.textContent=e);new bootstrap.Toast(t).show()}else alert(e)}async handleSubmit(e){e&&e.preventDefault();const t=document.getElementById("btnSaveTransaction");if(t)try{const e=this.getFormData();if(!this.validateFormData(e))return;t.innerHTML;let s;if(t.disabled=!0,t.innerHTML='<i class="fas fa-spinner fa-spin me-2"></i>Saving...',s="update"===this.mode?await S.transactions.updateTransaction(this.assetTransactionsId,e):await S.transactions.createTransaction(e),!s.isSuccess)throw new Error(s.message||"Failed to save transaction");{const e="update"===this.mode?"Transaction updated successfully!":"Transaction created successfully!";this.showSuccess(e),setTimeout(()=>{this.cleanupAndNavigate()},1500)}}catch(s){this.showError(s.message||"Failed to save transaction. Please try again.")}finally{t&&(t.disabled=!1,t.innerHTML='<i class="fas fa-save me-2"></i>Save Transaction')}}handleCancel(){this.cleanupAndNavigate()}cleanupAndNavigate(){sessionStorage.removeItem("crudMode"),sessionStorage.removeItem("crudId"),window.router?window.router.navigate("transactions"):window.location.href="/transactions"}destroy(){if(this.handleSubmitBound){const e=document.getElementById("transactionForm"),t=document.getElementById("btnSaveTransaction");e&&e.removeEventListener("submit",this.handleSubmitBound),t&&t.removeEventListener("click",this.handleSubmitBound)}if(this.handleCancelBound){const e=document.getElementById("btnCancelTransaction"),t=document.getElementById("btnBackToTransactions");e&&e.removeEventListener("click",this.handleCancelBound),t&&t.removeEventListener("click",this.handleCancelBound)}this.handleSubmitBound=null,this.handleCancelBound=null,this.initialized=!1}};const ee=new class{constructor(){this.reports=[{id:1,name:"Asset Transaction Report",apiAvailable:!0,format:"excel"},{id:2,name:"Surat Serah Terima Asset",apiAvailable:!1,format:"excel"}],this.isDownloading=!1,this.downloadAttempts=0,this.maxAttempts=2}initialize(){this.setupEventListeners(),this.renderReportOptions()}setupEventListeners(){const e=document.getElementById("btnDownloadReport");e&&e.addEventListener("click",()=>this.downloadReport());document.querySelectorAll('[data-action="download-report"]').forEach(e=>{e.addEventListener("click",()=>this.downloadReport())})}renderReportOptions(){const e=document.getElementById("selectReport");if(e){for(;e.options.length>1;)e.remove(1);this.reports.forEach(t=>{const s=document.createElement("option");s.value=t.id,s.textContent=t.name,s.dataset.available=t.apiAvailable,t.apiAvailable||(s.disabled=!0,s.textContent+=" (Coming Soon)",s.style.color="#999"),e.appendChild(s)})}}async downloadReport(){if(this.isDownloading)return void this.showNotification("warning","Download is already in progress...",2e3);const e=document.getElementById("selectReport");if(!e)return void this.showNotification("error","Report selection not found");const t=parseInt(e.value),s=this.reports.find(e=>e.id===t);if(s)if(s.apiAvailable)try{if(!(await this.showConfirmModal("Download Report",'Download "'.concat(s.name,'" in Excel format?'),"Download","Cancel")))return;this.isDownloading=!0,this.downloadAttempts=0,this.updateDownloadButton(!0),this.showNotification("info","Preparing your report...",0);const e=await this.downloadWithRetry();if(!e.success)throw new Error(e.error||"Download failed");this.showNotification("success","âœ… Report downloaded successfully!<br>\n           <small>File: ".concat(e.filename," (").concat(Math.round(e.size/1024)," KB)</small>"),5e3)}catch(a){let e="Failed to download report";e=a.message.includes("401")||a.message.includes("session")?"Session expired. Please login again.":a.message.includes("Network")?"Network error. Please check your connection.":a.message.includes("empty")?"Server returned empty file. Please try again.":a.message||e,this.showNotification("error",e,5e3)}finally{this.isDownloading=!1,this.updateDownloadButton(!1)}else this.showNotification("info","This report feature is coming soon");else this.showNotification("warning","Please select a report")}async downloadWithRetry(){for(;this.downloadAttempts<this.maxAttempts;){this.downloadAttempts++;try{if(1===this.downloadAttempts)return await w.downloadExcelReport();{const e=await w.generateExcelReport();if(e.success)return w.downloadBlob(e.blob,e.filename),e}}catch(e){if(!(this.downloadAttempts<this.maxAttempts))throw e;this.showNotification("warning","Retrying download (".concat(this.downloadAttempts,"/").concat(this.maxAttempts,")..."),2e3),await new Promise(e=>setTimeout(e,1e3))}}throw new Error("All download attempts failed")}updateDownloadButton(e){const t=document.getElementById("btnDownloadReport");t&&(e?(t.disabled=!0,t.innerHTML='\n        <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>\n        Downloading...\n      '):(t.disabled=!1,t.innerHTML="Download Report"))}async showConfirmModal(e,t,s="OK",a="Cancel"){if(O&&"function"==typeof O.show)try{return await O.show({type:"confirm",title:e,message:t,okText:s,cancelText:a})}catch(n){}return window.confirm("".concat(e,"\n\n").concat(t))}showNotification(e,t,s=3e3){window.showNotification&&"function"==typeof window.showNotification?window.showNotification(e,t,s):this.showFallbackNotification(e,t,s)}showFallbackNotification(e,t,s){document.querySelectorAll(".report-notification-fallback").forEach(e=>e.remove());const a=document.createElement("div");if(a.className="report-notification-fallback alert alert-".concat(this.getAlertType(e)),a.style.cssText="\n      position: fixed;\n      top: 20px;\n      right: 20px;\n      z-index: 9999;\n      min-width: 300px;\n      max-width: 500px;\n      box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n      animation: slideInRight 0.3s ease;\n    ",a.innerHTML='\n      <div class="d-flex align-items-center">\n        <div class="flex-grow-1">'.concat(t,'</div>\n        <button type="button" class="btn-close ms-2" onclick="this.parentElement.parentElement.remove()"></button>\n      </div>\n    '),document.body.appendChild(a),s>0&&setTimeout(()=>{a.parentNode&&a.remove()},s),!document.querySelector("#notification-styles")){const e=document.createElement("style");e.id="notification-styles",e.textContent="\n        @keyframes slideInRight {\n          from { transform: translateX(100%); opacity: 0; }\n          to { transform: translateX(0); opacity: 1; }\n        }\n        .report-notification-fallback {\n          font-size: 14px;\n        }\n      ",document.head.appendChild(e)}}getAlertType(e){return{success:"success",error:"danger",warning:"warning",info:"info"}[e]||"info"}triggerDownload(e=1){const t=document.getElementById("selectReport");t&&(t.value=e),this.downloadReport()}};"undefined"!=typeof window&&(window.reportsMenu=ee,window.downloadTestReport=()=>{w.testDownload().then(e=>{}).catch(e=>{}).finally(()=>{})});const te=new class{constructor(){this.currentUser=this.loadUserData()}initialize(){this.setupEventListeners()}loadUserData(){const e=localStorage.getItem("currentUser");return e?JSON.parse(e):{name:"John Doe",email:"john.doe@company.com",avatar:null}}setupEventListeners(){const e=document.getElementById("changeAvatarBtn");e&&e.addEventListener("click",e=>{e.preventDefault(),this.handleChangeAvatar()});const t=document.getElementById("changePasswordBtn");t&&t.addEventListener("click",e=>{e.preventDefault(),this.handleChangePassword()});const s=document.getElementById("profileForm");s&&s.addEventListener("submit",e=>{e.preventDefault(),this.handleSaveProfile()});const a=document.getElementById("resetFormBtn");a&&a.addEventListener("click",e=>{e.preventDefault(),this.handleResetForm()});const n=document.getElementById("cancelProfileBtn");n&&n.addEventListener("click",e=>{e.preventDefault(),this.handleCancel()})}handleChangeAvatar(){const e=document.createElement("input");e.type="file",e.accept="image/*",e.style.display="none",e.addEventListener("change",e=>{const t=e.target.files[0];t&&this.previewAvatar(t)}),document.body.appendChild(e),e.click(),document.body.removeChild(e)}previewAvatar(e){const t=new FileReader;t.onload=e=>{const t=document.querySelector(".profile-avatar img");t&&(t.src=e.target.result,this.currentUser.avatar=e.target.result,localStorage.setItem("currentUser",JSON.stringify(this.currentUser)),this.showNotification("success","âœ… Avatar updated!"))},t.readAsDataURL(e)}handleChangePassword(){window.router?window.router.navigate("reset-password"):window.location.href="/reset-password"}handleSaveProfile(){var e,t,s,a,n,i,o,r,c,l;const d=null==(e=document.getElementById("firstName"))?void 0:e.value,h=null==(t=document.getElementById("lastName"))?void 0:t.value,u=null==(s=document.getElementById("profileEmail"))?void 0:s.value;null==(a=document.getElementById("profilePhone"))||a.value,null==(n=document.getElementById("profileBio"))||n.value,null==(i=document.getElementById("profileDepartment"))||i.value,null==(o=document.getElementById("profilePosition"))||o.value,null==(r=document.getElementById("profileLocation"))||r.value,null==(c=document.getElementById("profileLanguage"))||c.value,null==(l=document.getElementById("profileTimezone"))||l.value;if(!d||!h||!u)return void this.showNotification("danger","âŒ Please fill in all required fields");const m=document.getElementById("saveProfileBtn");if(m){const e=m.innerHTML;m.innerHTML='<i class="fas fa-spinner fa-spin me-2"></i>Saving...',m.disabled=!0,setTimeout(()=>{m.innerHTML=e,m.disabled=!1,this.showNotification("success","âœ… Profile updated successfully!")},1e3)}}handleResetForm(){const e=document.getElementById("profileForm");e&&(e.reset(),this.showNotification("info","â†» Form reset to default values"))}handleCancel(){window.router?window.router.navigate("dashboard"):window.location.href="/dashboard"}handleSavePassword(e){const t=document.getElementById("currentPassword").value,s=document.getElementById("newPassword").value,a=document.getElementById("confirmPassword").value;t&&s&&a?s===a?s.length<8?this.showNotification("danger","âŒ Password must be at least 8 characters"):(e.hide(),this.showNotification("success","âœ… Password changed successfully!")):this.showNotification("danger","âŒ Passwords do not match"):this.showNotification("danger","âŒ Please fill in all fields")}showNotification(e,t){"undefined"!=typeof RedAdminUtils&&RedAdminUtils.showNotification?RedAdminUtils.showNotification(e,t):alert(t)}};const se=new class{constructor(){this.settings=this.loadSettings()}initialize(){this.setupEventListeners(),this.populateForm()}loadSettings(){const e=localStorage.getItem("appSettings");return e?JSON.parse(e):{appName:"RedAdmin Pro",timeZone:"UTC-5 (EST)",language:"English",currency:"USD",emailNotif:!0,pushNotif:!0,smsNotif:!1,twoFactor:!1,loginAlerts:!0,sessionTimeout:"30"}}setupEventListeners(){const e=document.getElementById("settingsForm");e&&e.addEventListener("submit",e=>(e.preventDefault(),this.handleSave(),!1));const t=document.getElementById("saveSettingsBtn");t&&t.addEventListener("click",e=>{e.preventDefault(),this.handleSave()});const s=document.getElementById("cancelSettingsBtn");s&&(s.innerHTML='<i class="fas fa-redo me-2"></i>Reset to Saved',s.addEventListener("click",async()=>{await O.show({type:"warning",title:"Reset Settings",message:"Discard all changes and reset to last saved settings?",okText:"Reset",cancelText:"Keep Changes",okClass:"btn-warning"})&&(this.populateForm(),this.showNotification("info","Changes discarded"))}))}populateForm(){this.setInputValue("appName",this.settings.appName),this.setInputValue("timeZone",this.settings.timeZone),this.setInputValue("language",this.settings.language),this.setInputValue("currency",this.settings.currency),this.setCheckboxValue("emailNotif",this.settings.emailNotif),this.setCheckboxValue("pushNotif",this.settings.pushNotif),this.setCheckboxValue("smsNotif",this.settings.smsNotif),this.setCheckboxValue("twoFactor",this.settings.twoFactor),this.setCheckboxValue("loginAlerts",this.settings.loginAlerts),this.setInputValue("sessionTimeout",this.settings.sessionTimeout)}setInputValue(e,t){const s=document.getElementById(e);s&&(s.value=t||"")}setCheckboxValue(e,t){const s=document.getElementById(e);s&&(s.checked=Boolean(t))}getInputValue(e){const t=document.getElementById(e);return t?t.value:""}getCheckboxValue(e){const t=document.getElementById(e);return!!t&&t.checked}async handleSave(){try{if(!(await O.show({type:"confirm",title:"Save Settings",message:"Save these settings? This will update your application preferences.",okText:"Save Settings",cancelText:"Cancel",okClass:"btn-primary"})))return;this.settings={appName:this.getInputValue("appName"),timeZone:this.getInputValue("timeZone"),language:this.getInputValue("language"),currency:this.getInputValue("currency"),emailNotif:this.getCheckboxValue("emailNotif"),pushNotif:this.getCheckboxValue("pushNotif"),smsNotif:this.getCheckboxValue("smsNotif"),twoFactor:this.getCheckboxValue("twoFactor"),loginAlerts:this.getCheckboxValue("loginAlerts"),sessionTimeout:this.getInputValue("sessionTimeout")},localStorage.setItem("appSettings",JSON.stringify(this.settings)),this.showNotification("success","âœ… Settings saved successfully!")}catch(e){this.showNotification("danger","âŒ Failed to save settings")}}showNotification(e,t){"undefined"!=typeof RedAdminUtils&&RedAdminUtils.showNotification?RedAdminUtils.showNotification(e,t):alert(t)}};const ae=new class{constructor(){this.data=this.generateSampleData(),this.filteredData=[...this.data],this.selectedIds=new Set,this.currentPage=1,this.pageSize=10,this.filters={department:"",status:"",salary:""}}initialize(){this.setupEventListeners(),this.render()}generateSampleData(){const e=["John Doe","Jane Smith","Bob Johnson","Alice Williams","Charlie Brown","Diana Prince","Ethan Hunt","Fiona Gallagher","George Martin","Hannah Montana","Ian Fleming","Julia Roberts","Kevin Hart","Laura Palmer","Michael Scott","Nancy Drew","Oliver Twist","Peter Parker","Quinn Fabray","Rachel Green"],t=["Software Engineer","Product Manager","UX Designer","Data Analyst","DevOps Engineer"],s=["Engineering","Marketing","Sales","HR","Finance"],a=["Active","Inactive"];return Array.from({length:50},(n,i)=>({id:i+1,name:e[i%e.length],email:"employee".concat(i+1,"@company.com"),position:t[Math.floor(Math.random()*t.length)],department:s[Math.floor(Math.random()*s.length)],salary:Math.floor(8e4*Math.random())+4e4,status:a[Math.floor(Math.random()*a.length)]}))}setupEventListeners(){const e=document.getElementById("searchInput");if(e){let t;e.addEventListener("input",e=>{clearTimeout(t),t=setTimeout(()=>{this.handleSearch(e.target.value)},300)})}const t=document.getElementById("btnAddEmployee");t&&t.addEventListener("click",()=>this.handleAdd());const s=document.getElementById("btnImport");s&&s.addEventListener("click",()=>this.handleImport());const a=document.getElementById("btnExport");a&&a.addEventListener("click",()=>this.handleExport());const n=document.getElementById("btnBatchDelete");n&&n.addEventListener("click",()=>this.handleBatchDelete());const i=document.getElementById("btnBatchExport");i&&i.addEventListener("click",()=>this.handleBatchExport());const o=document.getElementById("selectAll");o&&o.addEventListener("change",e=>this.handleSelectAll(e.target.checked));const r=document.getElementById("btnApplyFilters");r&&r.addEventListener("click",()=>this.applyFilters());const c=document.getElementById("btnResetFilters");c&&c.addEventListener("click",()=>this.resetFilters())}handleSearch(e){const t=e.toLowerCase();this.filteredData=this.data.filter(e=>e.name.toLowerCase().includes(t)||e.email.toLowerCase().includes(t)||e.position.toLowerCase().includes(t)||e.department.toLowerCase().includes(t)),this.currentPage=1,this.selectedIds.clear(),this.render()}applyFilters(){var e,t,s;this.filters.department=(null==(e=document.getElementById("filterDepartment"))?void 0:e.value)||"",this.filters.status=(null==(t=document.getElementById("filterStatus"))?void 0:t.value)||"",this.filters.salary=(null==(s=document.getElementById("filterSalary"))?void 0:s.value)||"",this.filteredData=this.data.filter(e=>{let t=!0;if(this.filters.department&&e.department!==this.filters.department&&(t=!1),this.filters.status&&e.status!==this.filters.status&&(t=!1),this.filters.salary){const s=e.salary;"0-50000"===this.filters.salary?t=t&&s>=0&&s<=5e4:"50000-80000"===this.filters.salary?t=t&&s>5e4&&s<=8e4:"80000-100000"===this.filters.salary?t=t&&s>8e4&&s<=1e5:"100000+"===this.filters.salary&&(t=t&&s>1e5)}return t}),this.currentPage=1,this.selectedIds.clear(),this.render(),this.showNotification("success","Filters applied successfully")}resetFilters(){this.filters={department:"",status:"",salary:""},document.getElementById("filterDepartment").value="",document.getElementById("filterStatus").value="",document.getElementById("filterSalary").value="",this.filteredData=[...this.data],this.currentPage=1,this.selectedIds.clear(),this.render(),this.showNotification("info","Filters reset")}handleSelectAll(e){const t=(this.currentPage-1)*this.pageSize,s=t+this.pageSize,a=this.filteredData.slice(t,s);e?a.forEach(e=>this.selectedIds.add(e.id)):a.forEach(e=>this.selectedIds.delete(e.id)),this.updateBatchButtons(),this.updateTableCheckboxes()}handleCheckbox(e,t){t?this.selectedIds.add(e):this.selectedIds.delete(e),this.updateBatchButtons(),this.updateSelectAllCheckbox()}async handleAdd(){await O.show({type:"confirm",title:"Add New Employee",message:"This will open the employee creation form. Continue?",okText:"Continue",cancelText:"Cancel"})&&(window.location.hash="#employeecrud",sessionStorage.setItem("employeeCrudMode","add"))}async handleEdit(e){const t=this.data.find(t=>t.id===e);if(!t)return;await O.show({type:"confirm",title:"Edit Employee",message:"Edit information for ".concat(t.name,"?"),okText:"Edit",cancelText:"Cancel"})&&(window.location.hash="#employeecrud",sessionStorage.setItem("employeeCrudMode","edit"),sessionStorage.setItem("employeeCrudId",e))}async handleDelete(e){const t=this.data.find(t=>t.id===e);if(!t)return;await O.show({type:"danger",title:"Delete Employee",message:"Are you sure you want to delete ".concat(t.name,"? This action cannot be undone."),okText:"Delete",cancelText:"Cancel",okClass:"btn-danger"})&&(this.data=this.data.filter(t=>t.id!==e),this.filteredData=this.filteredData.filter(t=>t.id!==e),this.selectedIds.delete(e),this.render(),this.showNotification("success","Employee deleted successfully"))}async handleBatchDelete(){if(0===this.selectedIds.size)return;await O.show({type:"danger",title:"Delete Multiple Employees",message:"Are you sure you want to delete ".concat(this.selectedIds.size," employee(s)? This action cannot be undone."),okText:"Delete All",cancelText:"Cancel",okClass:"btn-danger"})&&(this.data=this.data.filter(e=>!this.selectedIds.has(e.id)),this.filteredData=this.filteredData.filter(e=>!this.selectedIds.has(e.id)),this.selectedIds.clear(),this.render(),this.showNotification("success","Selected employees deleted successfully"))}handleBatchExport(){const e=this.data.filter(e=>this.selectedIds.has(e.id));this.exportToCSV(e)}handleImport(){this.showNotification("info","Import functionality - Coming soon!")}handleExport(){this.exportToCSV(this.filteredData)}exportToCSV(e=this.filteredData){const t=[["ID","Name","Email","Position","Department","Salary","Status"].join(","),...e.map(e=>[e.id,e.name,e.email,e.position,e.department,e.salary,e.status].join(","))].join("\n"),s=new Blob([t],{type:"text/csv"}),a=window.URL.createObjectURL(s),n=document.createElement("a");n.href=a,n.download="employees-".concat(Date.now(),".csv"),n.click(),window.URL.revokeObjectURL(a),this.showNotification("success","Data exported successfully")}render(){const e=document.getElementById("employeeTableBody"),t=document.getElementById("emptyState");if(!e)return;const s=(this.currentPage-1)*this.pageSize,a=s+this.pageSize,n=this.filteredData.slice(s,a);if(0===n.length)return e.closest(".table-responsive").classList.add("d-none"),t&&t.classList.remove("d-none"),void this.updateStats();e.closest(".table-responsive").classList.remove("d-none"),t&&t.classList.add("d-none");const i=document.createDocumentFragment();n.forEach((e,t)=>{const a=document.createElement("tr");a.innerHTML='\n                <td>\n                    <input type="checkbox" class="form-check-input row-checkbox" \n                           data-id="'.concat(e.id,'" ').concat(this.selectedIds.has(e.id)?"checked":"",">\n                </td>\n                <td>").concat(s+t+1,"</td>\n                <td><strong>").concat(e.name,'</strong></td>\n                <td><a href="mailto:').concat(e.email,'">').concat(e.email,"</a></td>\n                <td>").concat(e.position,'</td>\n                <td><span class="badge bg-info">').concat(e.department,"</span></td>\n                <td>$").concat(e.salary.toLocaleString(),'</td>\n                <td><span class="badge bg-').concat("Active"===e.status?"success":"secondary",'">').concat(e.status,'</span></td>\n                <td>\n                    <button class="btn btn-sm btn-outline-primary btn-edit" data-id="').concat(e.id,'" title="Edit">\n                        <i class="fas fa-edit"></i>\n                    </button>\n                    <button class="btn btn-sm btn-outline-danger btn-delete" data-id="').concat(e.id,'" title="Delete">\n                        <i class="fas fa-trash"></i>\n                    </button>\n                </td>\n            '),i.appendChild(a)}),e.innerHTML="",e.appendChild(i),this.attachRowEventListeners(),this.updateStats(),this.renderPagination(),this.updateBatchButtons(),this.updateSelectAllCheckbox()}attachRowEventListeners(){document.querySelectorAll(".row-checkbox").forEach(e=>{e.addEventListener("change",e=>{const t=parseInt(e.target.dataset.id);this.handleCheckbox(t,e.target.checked)})}),document.querySelectorAll(".btn-edit").forEach(e=>{e.addEventListener("click",e=>{const t=parseInt(e.currentTarget.dataset.id);this.handleEdit(t)})}),document.querySelectorAll(".btn-delete").forEach(e=>{e.addEventListener("click",e=>{const t=parseInt(e.currentTarget.dataset.id);this.handleDelete(t)})})}updateStats(){const e=document.getElementById("totalEmployees"),t=document.getElementById("showingCount"),s=document.getElementById("totalCount");e&&(e.textContent=this.data.length),t&&(t.textContent=this.filteredData.length),s&&(s.textContent=this.data.length)}updateBatchButtons(){const e=document.getElementById("btnBatchDelete"),t=document.getElementById("btnBatchExport"),s=document.getElementById("selectedCount"),a=this.selectedIds.size>0;e&&(e.disabled=!a),t&&(t.disabled=!a),s&&(a?(s.textContent="".concat(this.selectedIds.size," selected"),s.style.display="inline-block"):s.style.display="none")}updateSelectAllCheckbox(){const e=document.getElementById("selectAll");if(!e)return;const t=(this.currentPage-1)*this.pageSize,s=t+this.pageSize,a=this.filteredData.slice(t,s),n=a.length>0&&a.every(e=>this.selectedIds.has(e.id));e.checked=n}updateTableCheckboxes(){document.querySelectorAll(".row-checkbox").forEach(e=>{const t=parseInt(e.dataset.id);e.checked=this.selectedIds.has(t)})}renderPagination(){const e=Math.ceil(this.filteredData.length/this.pageSize),t=document.getElementById("pagination");if(!t||e<=1)return void(t&&(t.innerHTML=""));let s="";s+='<li class="page-item '.concat(1===this.currentPage?"disabled":"",'">\n            <button class="page-link" data-page="').concat(this.currentPage-1,'">Previous</button>\n        </li>');for(let a=1;a<=e;a++)1===a||a===e||a>=this.currentPage-1&&a<=this.currentPage+1?s+='<li class="page-item '.concat(a===this.currentPage?"active":"",'">\n                    <button class="page-link" data-page="').concat(a,'">').concat(a,"</button>\n                </li>"):a!==this.currentPage-2&&a!==this.currentPage+2||(s+='<li class="page-item disabled"><span class="page-link">...</span></li>');s+='<li class="page-item '.concat(this.currentPage===e?"disabled":"",'">\n            <button class="page-link" data-page="').concat(this.currentPage+1,'">Next</button>\n        </li>'),t.innerHTML=s,t.querySelectorAll("button[data-page]").forEach(t=>{t.addEventListener("click",()=>{const s=parseInt(t.dataset.page);s>=1&&s<=e&&(this.currentPage=s,this.render())})})}showNotification(e,t){window.showNotification&&window.showNotification(e,t)}},ne={};const ie=new class{constructor(){this.formData={},this.currentStep=1,this.validationRules=this.setupValidation()}initialize(){this.setupEventListeners(),this.loadSavedData(),this.enableAutoSave()}setupValidation(){return{productName:{required:!0,minLength:3},category:{required:!0},price:{required:!0,min:0},email:{required:!0,pattern:/^[^\s@]+@[^\s@]+\.[^\s@]+$/}}}setupEventListeners(){document.querySelectorAll("#model2Page input, #model2Page select, #model2Page textarea").forEach(e=>{e.addEventListener("blur",e=>this.validateField(e.target)),e.addEventListener("input",e=>{this.formData[e.target.id||e.target.name]=e.target.value})});const e=document.getElementById("saveProductBtn");e&&e.addEventListener("click",e=>{e.preventDefault(),this.handleSubmit()});const t=document.getElementById("resetFormBtn");t&&t.addEventListener("click",e=>{e.preventDefault(),this.handleReset()}),this.addAutoComplete()}validateField(e){const t=e.id||e.name,s=e.value,a=this.validationRules[t];if(!a)return!0;let n=!0,i="";if(a.required&&!s?(n=!1,i="This field is required"):a.minLength&&s.length<a.minLength?(n=!1,i="Minimum ".concat(a.minLength," characters required")):a.min&&parseFloat(s)<a.min?(n=!1,i="Value must be at least ".concat(a.min)):a.pattern&&!a.pattern.test(s)&&(n=!1,i="Invalid format"),n)e.classList.remove("is-invalid"),e.classList.add("is-valid");else{e.classList.remove("is-valid"),e.classList.add("is-invalid");let t=e.nextElementSibling;t&&t.classList.contains("invalid-feedback")||(t=document.createElement("div"),t.className="invalid-feedback",e.parentNode.appendChild(t)),t.textContent=i}return n}handleSubmit(){var e,t,s,a,n,i,o,r,c,l,d,h,u,m,g,p,y;const f={name:(null==(e=document.getElementById("productName"))?void 0:e.value)||"",sku:(null==(t=document.getElementById("skuCode"))?void 0:t.value)||"",category:(null==(s=document.getElementById("productCategory"))?void 0:s.value)||"",brand:(null==(a=document.getElementById("productBrand"))?void 0:a.value)||"",description:(null==(n=document.getElementById("productDescription"))?void 0:n.value)||""};null==(i=document.getElementById("productWeight"))||i.value,null==(o=document.getElementById("productDimensions"))||o.value,null==(r=document.getElementById("productColor"))||r.value,null==(c=document.getElementById("productMaterial"))||c.value,null==(l=document.getElementById("feature1"))||l.checked,null==(d=document.getElementById("feature2"))||d.checked,null==(h=document.getElementById("feature3"))||h.checked,null==(u=document.getElementById("costPrice"))||u.value,null==(m=document.getElementById("sellingPrice"))||m.value,null==(g=document.getElementById("discountPercentage"))||g.value,null==(p=document.getElementById("taxRate"))||p.value,null==(y=document.getElementById("availableSwitch"))||y.checked;if(!f.name){this.showErrorMessage("Product name is required");const e=document.querySelector('a[href="#basicInfo"]');return void(e&&e.click())}const v=document.getElementById("saveProductBtn");if(v){const e=v.innerHTML;v.innerHTML='<i class="fas fa-spinner fa-spin me-2"></i>Saving...',v.disabled=!0,setTimeout(()=>{v.innerHTML=e,v.disabled=!1,this.showSuccessMessage("Product saved successfully!"),localStorage.removeItem("model2_formData")},1500)}}async handleReset(){const{confirmModal:e}=await function(e,t){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),a=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));s=Promise.allSettled(t.map(e=>{if((e=function(e){return"/"+e}(e))in ne)return;ne[e]=!0;const t=e.endsWith(".css"),s=t?'[rel="stylesheet"]':"";if(document.querySelector('link[href="'.concat(e,'"]').concat(s)))return;const n=document.createElement("link");return n.rel=t?"stylesheet":"modulepreload",t||(n.as="script"),n.crossOrigin="",n.href=e,a&&n.setAttribute("nonce",a),document.head.appendChild(n),t?new Promise((t,s)=>{n.addEventListener("load",t),n.addEventListener("error",()=>s(new Error("Unable to preload CSS for ".concat(e))))}):void 0}))}function a(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return s.then(t=>{for(const e of t||[])"rejected"===e.status&&a(e.reason);return e().catch(a)})}(async()=>{const{confirmModal:e}=await Promise.resolve().then(()=>H);return{confirmModal:e}},[]);if(await e.show({type:"warning",title:"Reset Form",message:"Are you sure you want to reset the form? All unsaved data will be lost.",okText:"Reset",cancelText:"Cancel",okClass:"btn-warning"})){this.formData={},localStorage.removeItem("model2_formData");document.querySelectorAll("#model2Page input, #model2Page select, #model2Page textarea").forEach(e=>{e.classList.remove("is-valid","is-invalid"),"checkbox"===e.type?e.checked=!1:e.value=""});document.querySelectorAll("#model2Page select").forEach(e=>{e.selectedIndex=0}),this.showSuccessMessage("Form reset successfully!")}}loadSavedData(){const e=localStorage.getItem("model2_formData");e&&(this.formData=JSON.parse(e),Object.keys(this.formData).forEach(e=>{const t=document.getElementById(e)||document.querySelector('[name="'.concat(e,'"]'));t&&(t.value=this.formData[e])}))}enableAutoSave(){setInterval(()=>{Object.keys(this.formData).length>0&&localStorage.setItem("model2_formData",JSON.stringify(this.formData))},3e4)}addAutoComplete(){const e=document.getElementById("category");if(e){const t=["Electronics","Clothing","Food","Books","Toys","Sports"];e.addEventListener("input",e=>{const s=e.target.value.toLowerCase();if(s.length<2)return;t.filter(e=>e.toLowerCase().includes(s))})}}showSuccessMessage(e){"undefined"!=typeof RedAdminUtils&&RedAdminUtils.showNotification?RedAdminUtils.showNotification("success",e):alert(e)}showErrorMessage(e){"undefined"!=typeof RedAdminUtils&&RedAdminUtils.showNotification?RedAdminUtils.showNotification("danger",e):alert(e)}};"undefined"!=typeof window&&(window.model2=ie);const oe=new class{constructor(){this.charts={},this.realTimeInterval=null,this.currentData=this.generateSampleData()}initialize(){this.initializeDateRange(),this.setupEventListeners(),this.initializeAllCharts(),this.updateStats(),this.startRealTimeUpdates()}generateSampleData(){const e=[],t=[];for(let s=6;s>=0;s--){const a=new Date;a.setDate(a.getDate()-s),e.push(a.toLocaleDateString("en-US",{month:"short",day:"numeric"})),t.push(Math.floor(5e3*Math.random())+1e4)}return{labels:e,revenue:t,categories:{labels:["Electronics","Clothing","Food","Books","Sports"],data:[35,25,20,12,8]},monthly:{labels:["Jan","Feb","Mar","Apr","May","Jun"],thisYear:[45e3,52e3,48e3,61e3,58e3,67e3],lastYear:[38e3,42e3,45e3,51e3,49e3,55e3]},performance:{labels:["Sales","Support","Marketing","Development","Quality"],data:[85,92,78,88,95]}}}initializeDateRange(){const e=new Date,t=new Date;t.setDate(e.getDate()-7);const s=document.getElementById("fromDate"),a=document.getElementById("toDate");s&&(s.valueAsDate=t),a&&(a.valueAsDate=e)}setupEventListeners(){const e=document.getElementById("btnRefreshCharts");e&&e.addEventListener("click",()=>this.refreshAllCharts());const t=document.getElementById("btnExportCharts");t&&t.addEventListener("click",()=>this.exportAllCharts()),["Line","Pie","Bar","Radar"].forEach(e=>{const t=document.getElementById("btnExport".concat(e,"Chart"));t&&t.addEventListener("click",()=>this.exportChart(e.toLowerCase()))});const s=document.getElementById("quickDateRange");s&&s.addEventListener("change",e=>this.handleQuickDateRange(e.target.value));const a=document.getElementById("btnApplyDateRange");a&&a.addEventListener("click",()=>this.applyDateRange());const n=document.getElementById("realTimeToggle");n&&n.addEventListener("change",e=>{e.target.checked?this.startRealTimeUpdates():this.stopRealTimeUpdates()})}initializeAllCharts(){"undefined"!=typeof Chart&&(this.initLineChart(),this.initPieChart(),this.initBarChart(),this.initRadarChart())}initLineChart(){const e=document.getElementById("lineChart");if(!e)return;const t=e.getContext("2d");this.charts.line=new Chart(t,{type:"line",data:{labels:this.currentData.labels,datasets:[{label:"Revenue",data:this.currentData.revenue,borderColor:"#dc2626",backgroundColor:"rgba(220, 38, 38, 0.1)",tension:.4,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0},tooltip:{callbacks:{label:e=>"Revenue: $".concat(e.parsed.y.toLocaleString())}}},scales:{y:{beginAtZero:!0,ticks:{callback:e=>"$"+e.toLocaleString()}}}}})}initPieChart(){const e=document.getElementById("pieChart");if(!e)return;const t=e.getContext("2d");this.charts.pie=new Chart(t,{type:"pie",data:{labels:this.currentData.categories.labels,datasets:[{data:this.currentData.categories.data,backgroundColor:["#dc2626","#3b82f6","#10b981","#f59e0b","#8b5cf6"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})}initBarChart(){const e=document.getElementById("barChart");if(!e)return;const t=e.getContext("2d");this.charts.bar=new Chart(t,{type:"bar",data:{labels:this.currentData.monthly.labels,datasets:[{label:"2024",data:this.currentData.monthly.thisYear,backgroundColor:"#dc2626"},{label:"2023",data:this.currentData.monthly.lastYear,backgroundColor:"#9ca3af"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0}},scales:{y:{beginAtZero:!0,ticks:{callback:e=>"$"+e/1e3+"k"}}}}})}initRadarChart(){const e=document.getElementById("radarChart");if(!e)return;const t=e.getContext("2d");this.charts.radar=new Chart(t,{type:"radar",data:{labels:this.currentData.performance.labels,datasets:[{label:"Performance Score",data:this.currentData.performance.data,borderColor:"#dc2626",backgroundColor:"rgba(220, 38, 38, 0.2)"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0}},scales:{r:{beginAtZero:!0,max:100}}}})}updateStats(){const e=this.currentData.revenue.reduce((e,t)=>e+t,0);document.getElementById("statRevenue").textContent="$"+e.toLocaleString(),document.getElementById("statRevenueChange").textContent="+12.5%",document.getElementById("statUsers").textContent="2,847",document.getElementById("statUsersChange").textContent="+8.2%",document.getElementById("statConversion").textContent="3.24%",document.getElementById("statConversionChange").textContent="-0.3%",document.getElementById("statAvgOrder").textContent="$"+(e/100).toFixed(0),document.getElementById("statAvgOrderChange").textContent="+5.1%"}refreshAllCharts(){this.currentData=this.generateSampleData(),Object.keys(this.charts).forEach(e=>{this.charts[e]&&(this.charts[e].data.labels=this.currentData.labels||this.charts[e].data.labels,this.charts[e].update())}),this.updateStats(),this.showNotification("success","Charts refreshed successfully")}exportChart(e){const t=this.charts[e];if(!t)return;const s=t.toBase64Image(),a=document.createElement("a");a.download="chart-".concat(e,"-").concat(Date.now(),".png"),a.href=s,a.click(),this.showNotification("success","".concat(e.charAt(0).toUpperCase()+e.slice(1)," chart exported"))}exportAllCharts(){Object.keys(this.charts).forEach(e=>{setTimeout(()=>this.exportChart(e),100*Object.keys(this.charts).indexOf(e))}),this.showNotification("success","All charts exported successfully")}handleQuickDateRange(e){const t=new Date;let s=new Date;switch(e){case"today":s=new Date;break;case"week":s.setDate(t.getDate()-7);break;case"month":s.setDate(t.getDate()-30);break;case"year":s.setFullYear(t.getFullYear()-1);break;default:return}document.getElementById("fromDate").valueAsDate=s,document.getElementById("toDate").valueAsDate=t}applyDateRange(){const e=document.getElementById("fromDate").value,t=document.getElementById("toDate").value;e&&t?(this.refreshAllCharts(),this.showNotification("success","Date range applied")):this.showNotification("warning","Please select both dates")}startRealTimeUpdates(){this.realTimeInterval||(this.realTimeInterval=setInterval(()=>{const e=document.getElementById("liveUsers"),t=document.getElementById("liveOrders"),s=document.getElementById("liveRevenue");e&&(e.textContent=Math.floor(100*Math.random())+150),t&&(t.textContent=Math.floor(10*Math.random())+5),s&&(s.textContent=(500*Math.random()+200).toFixed(2)),e&&t&&s||this.stopRealTimeUpdates()},2e3))}stopRealTimeUpdates(){this.realTimeInterval&&(clearInterval(this.realTimeInterval),this.realTimeInterval=null)}showNotification(e,t){window.showNotification&&window.showNotification(e,t)}destroy(){this.stopRealTimeUpdates(),Object.keys(this.charts).forEach(e=>{this.charts[e]&&this.charts[e].destroy()})}};new class{constructor(){this.initializedPages=new Set,this.pageInstances={},this.initializeListeners()}initializeListeners(){window.addEventListener("pageLoaded",e=>{const t=e.detail.path;this.initializePage(t)})}shouldReinitialize(e){if(["employeecrud","assetcrud","categorycrud","transactioncrud","dashboard","model1","model3"].includes(e))return!0;if(["employees","assets","categories","transactions","reports","model2","profile","settings","components","buttons"].includes(e)){const t=!this.initializedPages.has(e);return t}return!0}initializePage(e){const t=e.split("/").pop().replace(".html","");if(this.shouldReinitialize(t)){switch(t){case"dashboard":this.initializeDashboard();break;case"employees":this.initializeEmployees();break;case"employeecrud":this.initializeEmployeeCrud();break;case"assets":this.initializeAssets();break;case"assetcrud":this.initializeAssetCrud();break;case"categories":this.initializeCategories();break;case"categorycrud":this.initializeCategoryCrud();break;case"transactions":this.initializeTransactions();break;case"transactioncrud":this.initializeTransactionCrud();break;case"reports":this.initializeReports();break;case"profile":this.initializeProfile();break;case"settings":this.initializeSettings();break;case"model1":this.initializeModel1();break;case"model2":this.initializeModel2();break;case"model3":this.initializeModel3();break;case"login":case"register":case"forgot-password":case"reset-password":this.initializeAuthPages()}["employeecrud","assetcrud","categorycrud","transactioncrud"].includes(t)||this.initializedPages.add(t),this.initializePasswordToggles()}}initializeDashboard(){try{V.initialize()}catch(e){}}initializeEmployees(){try{Y.initialize()}catch(e){}}initializeEmployeeCrud(){try{W.initialize()}catch(e){}}initializeAssets(){try{G.initialize()}catch(e){}}initializeAssetCrud(){try{K.initialize()}catch(e){}}initializeCategories(){try{$.initialize()}catch(e){}}initializeCategoryCrud(){try{X.initialize()}catch(e){}}initializeTransactions(){try{Z.initialize()}catch(e){}}initializeTransactionCrud(){try{Q.initialize()}catch(e){}}initializeReports(){try{ee.initialize()}catch(e){}}initializeProfile(){try{te.initialize()}catch(e){}}initializeSettings(){try{se.initialize()}catch(e){}}initializeModel1(){try{ae.initialize()}catch(e){}}initializeModel2(){try{ie.initialize()}catch(e){}}initializeModel3(){try{oe.initialize()}catch(e){}}initializeAuthPages(){}initializePasswordToggles(){const e=document.querySelectorAll('.password-toggle, .password-toggle-btn, [data-toggle="password"]');0!==e.length&&e.forEach(e=>{const t=e.cloneNode(!0);e.parentNode.replaceChild(t,e),t.addEventListener("click",function(e){e.preventDefault();const t=this.closest(".form-floating, .input-group"),s=t?t.querySelector('input[type="password"], input[type="text"]'):this.previousElementSibling||this.parentElement.querySelector('input[type="password"], input[type="text"]');if(!s)return;const a=this.querySelector("i, .fa-eye, .fa-eye-slash");"password"===s.type?(s.type="text",a&&(a.classList.remove("fa-eye"),a.classList.add("fa-eye-slash"))):(s.type="password",a&&(a.classList.remove("fa-eye-slash"),a.classList.add("fa-eye")))})})}};new class{constructor(){this.init()}init(){document.addEventListener("click",e=>{const t=e.target.closest(".breadcrumb-item a[data-route]");if(t){e.preventDefault();const s=t.getAttribute("data-route");window.router?window.router.navigate(s):window.location.href="/"+s}})}},i.register(...o);const re=new class{constructor(){this.isInitialized=!1,this.version="2.0.0",this.api=S,window.bootstrap=a,window.Chart=i}async init(){if(!this.isInitialized)try{this.showLoadingScreen(),await this.initializeServices(),this.setupGlobalEvents(),await this.loadLayouts(),k.init(),this.initializeTheme(),this.setupUIHandlers(),this.isInitialized=!0,this.hideLoadingScreen(),B.emit("app:initialized")}catch(e){this.showError("Application failed to initialize")}}async initializeServices(){L.init(),B.on("auth:login-success",({user:e})=>{D.setUser(e),k.navigate("dashboard")}),B.on("auth:logout",()=>{D.clear(!0),k.navigate("login")}),B.on("auth:session-expired",()=>{x.warning("Your session has expired. Please login again."),k.navigate("login")}),B.on("notification:success",e=>{x.success(e)}),B.on("notification:error",e=>{x.error(e)}),B.on("notification:warning",e=>{x.warning(e)}),B.on("notification:info",e=>{x.info(e)}),B.on("api:error",e=>{this.handleAPIError(e)})}handleAPIError(e){401!==e.status&&(404===e.status?x.error("Resource not found"):500===e.status?x.error("Server error occurred. Please try again later."):x.error(e.message||"An error occurred"))}async testAPIConnection(){try{(await this.api.testConnection()).success}catch(e){}}async loadLayouts(){try{const e=await fetch("/layouts/sidebar.html"),t=await e.text(),s=document.getElementById("sidebar-container");s&&(s.innerHTML=t,setTimeout(()=>{var e;return null==(e=null==z?void 0:z.init)?void 0:e.call(z)},100));const a=await fetch("/layouts/topbar.html"),n=await a.text(),i=document.getElementById("topbar-container");i&&(i.innerHTML=n,this.initializeTopbar())}catch(e){this.showLayoutFallback()}}initializeTopbar(){const e=L.getCurrentUser();if(e){document.querySelectorAll(".user-name, .user-email").forEach(t=>{t.classList.contains("user-name")&&(t.textContent=e.fullName||e.email),t.classList.contains("user-email")&&(t.textContent=e.email)})}}showLayoutFallback(){}setupGlobalEvents(){let e;window.addEventListener("resize",()=>{clearTimeout(e),e=setTimeout(()=>{B.emit("window:resized",{width:window.innerWidth,height:window.innerHeight})},250)}),document.addEventListener("visibilitychange",()=>{B.emit("page:visibility-changed",{hidden:document.hidden})}),window.addEventListener("beforeunload",e=>{B.emit("app:before-unload")}),document.addEventListener("keydown",e=>{this.handleKeyboardShortcuts(e)}),B.on("app:loading",e=>{e?this.showLoading():this.hideLoading()})}handleKeyboardShortcuts(e){["INPUT","TEXTAREA","SELECT"].includes(e.target.tagName)||((e.ctrlKey||e.metaKey)&&"k"===e.key&&(e.preventDefault(),this.focusSearch()),(e.ctrlKey||e.metaKey)&&"b"===e.key&&(e.preventDefault(),this.toggleSidebar()),(e.ctrlKey||e.metaKey)&&"l"===e.key&&(e.preventDefault(),L.checkAuth()&&L.lockScreen()),"Escape"===e.key&&this.handleEscape(),"F5"===e.key&&e.preventDefault())}setupUIHandlers(){document.addEventListener("click",e=>{e.target.closest('[data-action="toggle-sidebar"]')&&(e.preventDefault(),this.toggleSidebar())}),document.addEventListener("click",e=>{e.target.closest('[data-action="toggle-theme"]')&&(e.preventDefault(),this.toggleTheme())}),document.addEventListener("click",e=>{e.target.closest('[data-action="show-notifications"]')&&(e.preventDefault(),this.showNotifications())}),document.addEventListener("click",e=>{e.target.closest('[data-action="show-inbox"]')&&(e.preventDefault(),R.show())}),document.addEventListener("click",e=>{e.target.closest('[data-action="toggle-search"]')&&(e.preventDefault(),F.show())}),document.addEventListener("click",e=>{e.target.closest('[data-action="toggle-fullscreen"]')&&(e.preventDefault(),this.toggleFullscreen())}),document.addEventListener("click",e=>{e.target.closest('[data-action="lock-screen"]')&&(e.preventDefault(),P.lock()),e.target.closest('[data-action="logout"]')&&(e.preventDefault(),this.handleLogout())}),document.addEventListener("click",e=>{e.target.matches(".sidebar-overlay")&&this.toggleSidebar()}),document.addEventListener("click",e=>{const t=e.target.closest(".submenu-toggle");if(t){e.preventDefault();const s=t.parentElement,a=s.querySelector(".submenu"),n=s.classList.contains("open");document.querySelectorAll(".has-submenu.open").forEach(e=>{e.classList.remove("open");const t=e.querySelector(".submenu");t&&t.classList.remove("show")}),n||(s.classList.add("open"),a&&a.classList.add("show"))}})}initializeTheme(){const e=D.getTheme();document.documentElement.setAttribute("data-theme",e),document.body.setAttribute("data-bs-theme",e)}toggleSidebar(){const e=document.querySelector(".sidebar-container"),t=document.querySelector(".sidebar-overlay"),s=document.body;window.innerWidth<=1024?(null==e||e.classList.toggle("show"),null==t||t.classList.toggle("show"),s.classList.toggle("sidebar-mobile-open")):(null==e||e.classList.toggle("collapsed"),s.classList.toggle("sidebar-collapsed"),D.toggleSidebar()),B.emit("sidebar:toggled",{collapsed:(null==e?void 0:e.classList.contains("collapsed"))||!1})}toggleTheme(){const e="light"===D.getTheme()?"dark":"light";D.setTheme(e),document.documentElement.setAttribute("data-theme",e),document.body.setAttribute("data-bs-theme",e),B.emit("theme:changed",{theme:e})}focusSearch(){const e=document.querySelector(".search-box input");e?e.focus():F.show()}showNotifications(){q.show()}toggleFullscreen(){document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen().catch(e=>{x.error("Error attempting to enable fullscreen: ".concat(e.message))})}handleEscape(){document.querySelectorAll(".modal.show").forEach(e=>{var t,s;const a=null==(s=null==(t=n)?void 0:t.getInstance)?void 0:s.call(t,e);a&&a.hide()});if(document.querySelectorAll(".dropdown-menu.show").forEach(e=>{e.classList.remove("show")}),window.innerWidth<=1024){document.querySelector(".sidebar-container.show")&&this.toggleSidebar()}}async handleLogout(){try{await O.show({title:"Confirm Logout",message:"Are you sure you want to logout?",confirmText:"Logout",confirmColor:"danger"})&&(await L.logout(),x.success("Logged out successfully"))}catch(e){x.error("Logout failed")}}showLoadingScreen(){const e='\n      <div id="app-loading-screen" class="loading-screen">\n        <div class="loading-content">\n          <div class="spinner-border text-primary" role="status">\n            <span class="visually-hidden">Loading...</span>\n          </div>\n          <h4 class="mt-3">RedAdmin Pro</h4>\n          <p class="text-muted">Loading application...</p>\n          <small class="version">v'.concat(this.version,"</small>\n        </div>\n      </div>\n    ");document.body.insertAdjacentHTML("beforeend",e)}hideLoadingScreen(){const e=document.getElementById("app-loading-screen");e&&(e.classList.add("fade-out"),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},300))}showLoading(){let e=document.getElementById("page-loader");e||(e=document.createElement("div"),e.id="page-loader",e.className="page-loader",e.innerHTML='<div class="spinner-border text-primary" role="status"></div>',document.body.appendChild(e)),e.classList.add("show")}hideLoading(){const e=document.getElementById("page-loader");e&&(e.classList.remove("show"),setTimeout(()=>{e&&!e.classList.contains("show")&&e.remove()},300))}showError(e){x.error(e)}getVersion(){return this.version}getInfo(){var e,t,s;return{version:this.version,initialized:this.isInitialized,currentRoute:null==(e=null==k?void 0:k.getCurrentRoute)?void 0:e.call(k),user:null==(t=null==D?void 0:D.getUser)?void 0:t.call(D),theme:null==(s=null==D?void 0:D.getTheme)?void 0:s.call(D),apiConnected:this.api?"connected":"disconnected",environment:"development",apiUrl:"Not set",debugMode:!1}}destroy(){B.off("auth:login-success"),B.off("auth:logout"),B.off("auth:session-expired"),B.off("notification:success"),B.off("notification:error"),B.off("notification:warning"),B.off("notification:info"),B.off("app:loading"),B.off("api:error"),this.isInitialized=!1}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>re.init()):setTimeout(()=>re.init(),0),window.RedAdminApp=re;export{s as __vite_legacy_guard};
